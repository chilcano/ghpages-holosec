---
layout: post
title: My 3 Ansible Roles to mass provision Kismet and Apache MiNiFi for wardriving
  at scale
date: 2017-03-29 21:10:25.000000000 +02:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Big Data
- DevOps
- IoT
- Security
tags:
- Ansible
- Apache MiNiFi
- Apache NiFi
- Raspberry Pi
meta:
  _wpcom_is_markdown: '1'
  geo_public: '0'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '3416834411'
  _publicize_done_external: a:1:{s:7:"twitter";a:1:{i:13849;s:54:"https://twitter.com/Chilcano/status/847179188092260352";}}
  _publicize_done_17477: '1'
  _wpas_done_13849: '1'
  publicize_twitter_user: Chilcano
  publicize_linkedin_url: https://www.linkedin.com/updates?discuss=&scope=6985267&stype=M&topic=6252944881350778880&type=U&a=y4pe
  _publicize_done_5110110: '1'
  _wpas_done_5053092: '1'
  _edit_last: '578869'
author:
  login: rcarhuatocto
  email: roger@intix.info
  display_name: Roger CARHUATOCTO
  first_name: ''
  last_name: ''
permalink: "/2017/03/29/my-3-ansible-roles-to-mass-provision-kismet-and-apache-minifi-for-wardriving-at-scale/"
---
<p>This blog post is implementing the same scenario used in the previous post <a href="https://holisticsecurity.io/2017/03/20/mass-provisioning-of-kismet-and-apache-minifi-in-raspberry-pi-using-ansible">Mass provisioning of Kismet and Apache MiNiFi in Raspberry Pi using Ansible</a>. The unique difference is this new blog post I'm using <a href="http://docs.ansible.com/ansible/playbooks_roles.html">Ansible Roles</a> instead of Ansible Playbooks where all automated operations as install, configure, run, etc. were implemented in Ansible Tasks.</p>
<p><img src="{{ site.baseurl }}/assets/mass-provisioning-kismet-minifi-raspberrypi-ansible-2-pkg.png" alt="https://holisticsecurity.files.wordpress.com/2017/03/mass-provisioning-kismet-minifi-raspberrypi-ansible-2-pkg.png" /></p>
<p><!-- more --></p>
<p>Then, I've refactored all Ansible Tasks and I've created 3 Ansible Roles. They are in Ansible Galaxy and are:</p>
<p><strong>Ansible Role Kismet RPi Build (https://galaxy.ansible.com/chilcano/kismet-rpi-build)</strong></p>
<p>An Ansible Role that builds / compiles from scratch and packs (Debian/Raspbian binary) Kismet on a Raspberry Pi. This Role provides the following features:</p>
<ul>
<li>Download the Kismet source code.</li>
<li>Compile the source code in a Raspberry Pi.</li>
<li>Generate a Kismet Debian/Raspbian package suitable for Raspberry Pi (ARMv7).</li>
</ul>
<p><strong>Ansible Role Kismet RPi Wardriving (https://galaxy.ansible.com/chilcano/kismet-rpi-wardriving)</strong></p>
<p>An Ansible Role that installs, configures and runs Kismet on a Raspberry Pi. This Role provides the following features:</p>
<ul>
<li>Install Kismet and dependencies.</li>
<li>Configure Kismet by deploying an customized <code>kismet.conf</code>.</li>
<li>Download MAC Addresses Manufacturer List.</li>
<li>Enable monitor mode in the Raspberry Pi before starting Kismet.</li>
<li>Run Kismet as a <code>systemd</code> service.</li>
</ul>
<p><strong>Ansible Role Apache MiNiFi (https://galaxy.ansible.com/chilcano/apache-minifi)</strong></p>
<p>An Ansible Role that installs, configures and runs Apache MiNiFi in tiny devices like a Raspberry Pi, although you can use it on any distro. This Role provides the following features:</p>
<ul>
<li>Install Apache MiNiFi and Java SDK.</li>
<li>Configure Apache MiNiFi.</li>
<li>Run Apache MiNiFi as a <code>systemd</code> service.</li>
</ul>
<h2>How to use everything</h2>
<p>Well, I've updated and deleted Ansible Tasks not used in the existing <a href="https://github.com/chilcano/ansible-raspberrypi-wardriving">Ansible Raspberry Pi Wardriving Github repo</a> because now I'm using 3 Ansible Roles. Just download the same Github repo with <code>Tag 2.0.0</code> and execute the new Ansible Playbook with the same <code>inventory</code> file.</p>
<p>Install all Ansible Roles needed as below or using <code>requirements.yml</code> file:</p>
<p>[code lang=text]<br />
$ sudo ansible-galaxy install geerlingguy.apache<br />
$ sudo ansible-galaxy install chilcano.kismet-rpi-build<br />
$ sudo ansible-galaxy install chilcano.kismet-rpi-wardriving<br />
$ sudo ansible-galaxy install chilcano.apache-minifi</p>
<p>$ ansible-galaxy list</p>
<p>- chilcano.apache-minifi, 1.0.1<br />
- chilcano.kismet-rpi-build, 1.0.4<br />
- chilcano.kismet-rpi-wardriving, 1.1.1<br />
- geerlingguy.apache, 2.0.1<br />
- knopki.locale, a1232f836b5514c58da381d9479640e40d874906<br />
- Stouts.hostname, 1.1.0<br />
- Stouts.timezone, 2.2.0<br />
[/code]</p>
<p>...and continue with this:</p>
<p>[code lang=text]<br />
$ git clone https://github.com/chilcano/ansible-raspberrypi-wardriving --branch 2.0.0 --single-branch</p>
<p>$ cd ansible-raspberrypi-wardriving</p>
<p>$ git tag -l<br />
1.0.0<br />
2.0.0</p>
<p>$ git checkout tags/2.0.0 -b 2.0.0</p>
<p>$ ansible-playbook -i inventory main_all.yml -k<br />
[/code]</p>
<p>And that's it !.<br />
I hope It helps.<br />
Bye.</p>
