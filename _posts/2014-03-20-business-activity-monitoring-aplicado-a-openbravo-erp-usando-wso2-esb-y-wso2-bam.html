---
layout: post
title: Business Activity Monitoring aplicado a Openbravo ERP usando WSO2 ESB y WSO2
  BAM
date: 2014-03-20 18:16:03.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- ERP
- SOA
tags:
- BAM
- KPI
- WSO2
meta:
  _wpcom_is_markdown: '1'
  _edit_last: '578869'
  _publicize_pending: '1'
  publicize_google_plus_url: https://plus.google.com/113031469837757886298/posts/7T3TtrmMstR
  _wpas_done_5053089: '1'
  _publicize_done_external: a:1:{s:11:"google_plus";a:1:{s:21:"113031469837757886298";b:1;}}
  publicize_twitter_user: Chilcano
  publicize_twitter_url: http://t.co/wxF6QIbuqw
  _wpas_done_13849: '1'
  publicize_linkedin_url: ''
  _wpas_done_5053092: '1'
  _wpas_skip_5053089: '1'
  _wpas_skip_13849: '1'
  _wpas_skip_5053092: '1'
author:
  login: rcarhuatocto
  email: roger@intix.info
  display_name: Roger CARHUATOCTO
  first_name: ''
  last_name: ''
permalink: "/2014/03/20/business-activity-monitoring-aplicado-a-openbravo-erp-usando-wso2-esb-y-wso2-bam/"
---
<p>Mi colega <a href="http://www.linkedin.com/in/luispenarrubia" title="Luis Peñarrubia @ LinkedIn" target="_blank">Luis Peñarrubia</a> ha publicado un detallado <a href="http://luispenarrubia.wordpress.com/2014/03/15/monitorizar-business-services-usando-wso2-esb-y-wso2-bam/" title="Monitorizar Business Services usando WSO2 ESB y WSO2 BAM" target="_blank">post de cómo usar WSO2 BAM, WSO2 ESB para monitorizar la capa de servicio de Openbravo ERP</a> (Data Access Layer).</p>
<p>Aquí os dejo el documento que explica cómo hacerlo paso a paso:</p>
<p>[slideshare id=32323468&amp;doc=chakray-monitorizacion-kpi-service-wso2esb-wso2bam-201403141-140314124059-phpapp02&amp;type=d]</p>
<p>Por otro lado, al desplegarlo en mi entorno, WSO2 BAM mostraba errores de autenticación de Apache Thrift con Apache Cassandra, como este:</p>
<p>[sourcecode language="text" gutter="true" wraplines="false"] </p>
<p>[2014-03-20 17:31:16,112]  INFO {org.wso2.carbon.ntask.core.service.impl.TaskServiceImpl} -  Task service starting in STANDALONE mode...<br />
[2014-03-20 17:31:16,285] ERROR {org.wso2.carbon.bam.notification.task.internal.NotificationDispatchComponent} -  InvalidRequestException(why:You have not logged in)<br />
me.prettyprint.hector.api.exceptions.HInvalidRequestException: InvalidRequestException(why:You have not logged in)<br />
	at me.prettyprint.cassandra.service.ExceptionsTranslatorImpl.translate(ExceptionsTranslatorImpl.java:45)<br />
	at me.prettyprint.cassandra.service.ThriftCluster$6.execute(ThriftCluster.java:164)<br />
	at me.prettyprint.cassandra.service.ThriftCluster$6.execute(ThriftCluster.java:151)<br />
	at me.prettyprint.cassandra.service.Operation.executeAndSetResult(Operation.java:103)<br />
	at me.prettyprint.cassandra.connection.HConnectionManager.operateWithFailover(HConnectionManager.java:258)<br />
	at me.prettyprint.cassandra.service.ThriftCluster.addKeyspace(ThriftCluster.java:168)</p>
<p>[...]</p>
<p>[2014-03-20 17:31:16,471]  INFO {org.wso2.carbon.databridge.core.DataBridge} -  admin connected<br />
[2014-03-20 17:31:16,473] ERROR {org.wso2.carbon.databridge.core.internal.authentication.Authenticator} -  wrong userName or password<br />
[2014-03-20 17:31:16,475] ERROR {org.wso2.carbon.bam.notification.task.NotificationDispatchTask} -  Error executing notification dispatch task: Cannot borrow client for TCP,10.10.10.24:7613,TCP,10.10.10.24:7713<br />
org.wso2.carbon.databridge.agent.thrift.exception.AgentException: Cannot borrow client for TCP,10.10.10.24:7613,TCP,10.10.10.24:7713<br />
	at org.wso2.carbon.databridge.agent.thrift.internal.publisher.authenticator.AgentAuthenticator.connect(AgentAuthenticator.java:58)<br />
	at org.wso2.carbon.databridge.agent.thrift.DataPublisher.start(DataPublisher.java:273)<br />
	at org.wso2.carbon.databridge.agent.thrift.DataPublisher.&lt;init&gt;(DataPublisher.java:211)<br />
	at org.wso2.carbon.bam.notification.task.NotificationDispatchTask.initPublisherKS(NotificationDispatchTask.java:103)<br />
	at org.wso2.carbon.bam.notification.task.NotificationDispatchTask.execute(NotificationDispatchTask.java:188)<br />
	at org.wso2.carbon.ntask.core.impl.TaskQuartzJobAdapter.execute(TaskQuartzJobAdapter.java:67)<br />
	at org.quartz.core.JobRunShell.run(JobRunShell.java:213)<br />
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)<br />
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)<br />
	at java.util.concurrent.FutureTask.run(FutureTask.java:166)<br />
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1146)<br />
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)<br />
	at java.lang.Thread.run(Thread.java:679)<br />
Caused by: org.wso2.carbon.databridge.commons.exception.AuthenticationException: Thrift Authentication Exception<br />
	at org.wso2.carbon.databridge.agent.thrift.internal.publisher.authenticator.ThriftAgentAuthenticator.connect(ThriftAgentAuthenticator.java:49)<br />
[...]<br />
[/sourcecode]</p>
<p>Esto se debe a que no he actualizado los ficheros de conexión con Apache Cassandra con las nuevas credenciales de WSO2 BAM, en mi caso no es admin/admin. Entonces, hay actualizar los siguientes ficheros:</p>
<p>[sourcecode language="text" gutter="true" wraplines="false"]<br />
$ nano /opt/wso2bam-2.4.0/repository/conf/etc/cassandra-auth.xml<br />
$ nano /opt/wso2bam-2.4.0/repository/conf/datasources/master-datasources.xml<br />
[/sourcecode]</p>
<p>Saludos.</p>
