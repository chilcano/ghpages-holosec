---
layout: post
title: Strategy to create (Micro)service using WSO2 and Docker
date: 2016-01-11 13:14:23.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- SOA
tags:
- Docker
- Microservices
- WSO2
meta:
  _wpcom_is_markdown: '1'
  geo_public: '0'
  _publicize_job_id: '18634999456'
  _oembed_77d16104310b6d7b1dc610c5bf8b4abe: "{{unknown}}"
  _wpas_skip_5053089: '1'
  _edit_last: '578869'
  publicize_google_plus_url: https://plus.google.com/+RogerCarhuatocto/posts/gpXegPcFat3
  _publicize_done_5110107: '1'
  _wpas_done_5053089: '1'
  _publicize_failed_5110110: |-
    O:13:"Keyring_Error":2:{s:6:"errors";a:1:{s:21:"keyring-request-error";a:1:{i:0;a:5:{s:7:"headers";a:11:{s:6:"server";s:17:"Apache-Coyote/1.1";s:15:"x-li-request-id";s:10:"5J87CWZWEH";s:4:"date";s:29:"Mon, 11 Jan 2016 12:14:27 GMT";s:4:"vary";s:1:"*";s:11:"x-li-format";s:4:"json";s:12:"content-type";s:30:"application/json;charset=UTF-8";s:16:"content-encoding";s:4:"gzip";s:11:"x-li-fabric";s:9:"prod-ltx1";s:8:"x-li-pop";s:9:"prod-ltx1";s:10:"set-cookie";s:155:"lidc="b=TB67:g=204:u=144:i=1452514468:t=1452587759:s=AQHTGkUBzlOCgLmOqaLqTFFMKxOV-PEO"; Expires=Tue, 12 Jan 2016 08:35:59 GMT; domain=.linkedin.com; Path=/";s:9:"x-li-uuid";s:24:"1MEGmTZeKBSAsCcF9SoAAA==";}s:4:"body";s:175:"{
      "errorCode": 0,
      "message": "[unauthorized]. Expired access token. Timestamp: 1452497141708",
      "requestId": "5J87CWZWEH",
      "status": 401,
      "timestamp": 1452514468446
    }";s:8:"response";a:2:{s:4:"code";i:401;s:7:"message";s:12:"Unauthorized";}s:7:"cookies";a:1:{i:0;O:14:"WP_Http_Cookie":5:{s:4:"name";s:4:"lidc";s:5:"value";s:81:""b=TB67:g=204:u=144:i=1452514468:t=1452587759:s=AQHTGkUBzlOCgLmOqaLqTFFMKxOV-PEO"";s:7:"expires";i:1452587759;s:4:"path";s:1:"/";s:6:"domain";s:13:".linkedin.com";}}s:8:"filename";N;}}}s:10:"error_data";a:0:{}}
  _publicize_done_external: a:1:{s:7:"twitter";a:1:{i:13849;s:54:"https://twitter.com/Chilcano/status/686521561717719041";}}
  _publicize_done_17477: '1'
  _wpas_done_13849: '1'
  publicize_twitter_user: Chilcano
  _wpas_skip_13849: '1'
  _wpas_skip_5053092: '1'
author:
  login: rcarhuatocto
  email: roger@intix.info
  display_name: Roger CARHUATOCTO
  first_name: ''
  last_name: ''
permalink: "/2016/01/11/strategy-to-create-microservices-using-wso2-and-docker/"
---
<p>The last year I was working in a big UK's project where I had to help in creation and preparation of the WSO2 Infrastructure to expose a bunch of functionalities as (Micro)services.</p>
<p>While we solve everyday problems in infrastructure such as Continuous Delivery, Security, Mediation, Logging, Testing, etc. I had to code many APIs and to explain how to do It to the other team members (Teaching by doing).</p>
<p><span class="hps">Based on</span> <span class="hps">this experience</span> <span class="hps">I will explain</span> <span class="hps">how to create an</span> <span class="hps">API</span> <span class="hps">layer</span> <span class="hps">from scratch </span><span class="hps">using</span> <span class="hps">WSO2 but avoiding the common errors and bad practices.</span></p>
<h2>(Micro)service Infrastructure</h2>
<p>Well, before stating you should choose your preferred Products/Frameworks/Stacks/PaaS and set up your Development and Production Environment Infrastructure.</p>
<p>Actually there are a few good Products/Frameworks/Stacks/PaaS ready to create and manage the (Micro)service Lifecycle such as:</p>
<ol>
<li>Dropwizard (http://www.dropwizard.io)</li>
<li>Deis (http://deis.io)</li>
<li>Spring Boot (http://projects.spring.io/spring-boot)</li>
<li>Ratpack (https://ratpack.io)</li>
<li>Spark with Unirest (http://sparkjava.com)</li>
<li>Vertx (http://vertx.io)</li>
<li>Seneca (http://senecajs.org - in Javascript / node.js)</li>
<li>WSO2 MSS (http://wso2.com/products/microservices-server - in Alpha)</li>
<li>Zato (https://zato.io - in Python)</li>
</ol>
<blockquote><p>If you want start working with (Micro)services but using WSO2 technology, I have created a set of Docker WSO2 containers where in a few minutes you will have a development platform running.</p></blockquote>
<p><a href="https://github.com/chilcano/docker-wso2-dev-srv"><img class="" src="{{ site.baseurl }}/assets/chilcano-wso2-dev-srv-docker-containers-map.png" alt="Docker Containers to develop (micro)services with WSO2" width="1308" height="997" /></a></p>
<p>Docker Containers to develop (micro)services with WSO2</p>
<p>Just follow these steps:</p>
<p>[sourcecode language="html" gutter="true" wraplines="false"]<br />
$ git clone https://github.com/chilcano/docker-wso2-dev-srv.git<br />
$ cd docker-wso2-dev-srv<br />
$ docker build --rm -t chilcano/wso2-esb:4.8.1 wso2esb/4.8.1<br />
$ docker run --detach -t --name=wso2esb01a -p 19449:9443 chilcano/wso2-esb:4.8.1<br />
[/sourcecode]</p>
<p>Or you can use the existing containers available in DockerHub (https://hub.docker.com/r/chilcano):</p>
<p>[sourcecode language="html" gutter="true" wraplines="false"]<br />
//Previous steps:<br />
$ git clone https://github.com/chilcano/docker-wso2-dev-srv.git<br />
$ cd docker-wso2-dev-srv</p>
<p>//Build image:<br />
$ docker build --rm -t chilcano/wso2-esb wso2esb/latest</p>
<p>//Run container:<br />
$ docker run -d -t --name=wso2esb01a -p 19449:9443 chilcano/wso2-esb</p>
<p>//Check the WSO2 server:<br />
$ docker exec -i -t wso2esb01a bash<br />
root@4178f21fcad3:/opt/wso2esb01a/bin# tail -f ../repository/logs/wso2carbon.log<br />
$ curl -v -k https://&amp;amp;amp;lt;IP_ADDRESS&amp;amp;amp;gt;:19449/services/Version<br />
[/sourcecode]</p>
<p>&nbsp;</p>
<h2>(Micro)service Methodology</h2>
<p>Obviously, the best methodology is what is created based on experience, there are good books and guides for that:</p>
<ul>
<li>Building Microservices By Sam Newman (http://shop.oreilly.com/product/0636920033158.do)</li>
<li>Microservices by Eberhard Wolff (http://microservices-book.com)</li>
<li>Microservices Guide by Martin Fowler (http://martinfowler.com/microservices)</li>
</ul>
<p>Also is very important internalize and understand the recommendations and best practices when creating (Micro)services, for example, here you could start with <strong>The twelve-factor app is a methodology (http://12factor.net)</strong> and implement the Support Infrastructure for (Micro)service such as:</p>
<ul>
<li>Service Discovery</li>
<li>Continuous Delivery &amp; Continuous Integration</li>
<li>Security &amp; Resilience</li>
<li>Monitoring</li>
<li>Logging</li>
<li>Etc.</li>
</ul>
<p>At the end, You will be ready to get starting to work with (Micro)services.</p>
