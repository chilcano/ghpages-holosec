<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part II) | Holistic Security</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part II)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="After configuring the Raspberry Pi to capture WIFI/802.11 traffic (first blog post), we have to store this traffic in a Database (NoSQL and RDBMS). The idea is to process in real-time and/or batch the stored data. Architecture IoT/BigData – Storing WIFI traffic in Apache Cassandra (WSO2 BAM and Apache Thrift To capture the WIFI/802.11 traffic is so difficult and in this second blog post I will explain how to address next difficults: Kismet captures 802.11 layer-2 wireless network traffic (Network IP blocks such as TCP, UDP, ARP, and DHCP packets) what should be decoded. The traffic should be captured and stored in real-time, we have to use a protocol optimized to capture quickly and low latency. The library that implements that protocol should have low memory footprint, because Kismet will run in a Raspberry Pi. The protocol to be used should be developer-friendly in both sides (Raspberry Pi side and WSO2 BAM - Apache Cassandra side)." />
<meta property="og:description" content="After configuring the Raspberry Pi to capture WIFI/802.11 traffic (first blog post), we have to store this traffic in a Database (NoSQL and RDBMS). The idea is to process in real-time and/or batch the stored data. Architecture IoT/BigData – Storing WIFI traffic in Apache Cassandra (WSO2 BAM and Apache Thrift To capture the WIFI/802.11 traffic is so difficult and in this second blog post I will explain how to address next difficults: Kismet captures 802.11 layer-2 wireless network traffic (Network IP blocks such as TCP, UDP, ARP, and DHCP packets) what should be decoded. The traffic should be captured and stored in real-time, we have to use a protocol optimized to capture quickly and low latency. The library that implements that protocol should have low memory footprint, because Kismet will run in a Raspberry Pi. The protocol to be used should be developer-friendly in both sides (Raspberry Pi side and WSO2 BAM - Apache Cassandra side)." />
<link rel="canonical" href="https://holisticsecurity.io/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/" />
<meta property="og:url" content="https://holisticsecurity.io/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/" />
<meta property="og:site_name" content="Holistic Security" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-02-04T18:22:57+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://holisticsecurity.io/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/"},"url":"https://holisticsecurity.io/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/","headline":"Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part II)","dateModified":"2016-02-04T18:22:57+01:00","datePublished":"2016-02-04T18:22:57+01:00","description":"After configuring the Raspberry Pi to capture WIFI/802.11 traffic (first blog post), we have to store this traffic in a Database (NoSQL and RDBMS). The idea is to process in real-time and/or batch the stored data. Architecture IoT/BigData – Storing WIFI traffic in Apache Cassandra (WSO2 BAM and Apache Thrift To capture the WIFI/802.11 traffic is so difficult and in this second blog post I will explain how to address next difficults: Kismet captures 802.11 layer-2 wireless network traffic (Network IP blocks such as TCP, UDP, ARP, and DHCP packets) what should be decoded. The traffic should be captured and stored in real-time, we have to use a protocol optimized to capture quickly and low latency. The library that implements that protocol should have low memory footprint, because Kismet will run in a Raspberry Pi. The protocol to be used should be developer-friendly in both sides (Raspberry Pi side and WSO2 BAM - Apache Cassandra side).","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://holisticsecurity.io/feed.xml" title="Holistic Security" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156433649-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/"><img src="/assets/img/logo-holosec.png" width="100" /> Holistic Security</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Home</a><a class="page-link" href="/blog/">Blog</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part II)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-02-04T18:22:57+01:00" itemprop="datePublished">Feb 4, 2016 
      </time>&sim; BIG DATA · IOT · SECURITY
      &sim; APACHE CASSANDRA · KISMET · PRIVACY · RASPBERRY PI
    </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>After configuring the Raspberry Pi to capture WIFI/802.11 traffic (<a href="/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i">first blog post</a>), we have to store this traffic in a Database (NoSQL and RDBMS). The idea is to process in real-time and/or batch the stored data.</p>

<p><a href="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-1-architecture.png" target="_blank"><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-1-architecture.png" alt=")" width="70%" /></a><br />
<em>Architecture IoT/BigData – Storing WIFI traffic in Apache Cassandra (WSO2 BAM and Apache Thrift</em></p>

<p>To capture the <code class="highlighter-rouge">WIFI/802.11</code> traffic is so difficult and in this second blog post I will explain how to address next difficults:</p>
<ul>
  <li>Kismet captures 802.11 layer-2 wireless network traffic (Network IP blocks such as TCP, UDP, ARP, and DHCP packets) what should be decoded.</li>
  <li>The traffic should be captured and stored in real-time, we have to use a protocol optimized to capture quickly and low latency.</li>
  <li>The library that implements that protocol should have low memory footprint, because Kismet will run in a Raspberry Pi.</li>
  <li>The protocol to be used should be developer-friendly in both sides (Raspberry Pi side and WSO2 BAM - Apache Cassandra side).</li>
</ul>

<!-- more -->

<h2 id="i--looking-for-the-streaming-andor-communication-protocol">I.- Looking for the Streaming and/or Communication Protocol</h2>

<p>There are some stream and communication protocols and implementations
Really, there are many libraries and streaming protocols out there to solve the above issues, but if you are looking for a protocol/library open source, lightweight, low memory footprint and developer friendly there are a few. They are:</p>

<p><strong>1) <a href="https://www.elastic.co/products/logstash">Elastic Logstash</a></strong></p>

<p>Logstash is a set of tools to collect heterogeneous type of data and It’s to used with Elasticsearch, It requires Java and for this reason It is too heavy to run in a Raspberry Pi. The best choice is to use only <code class="highlighter-rouge">Logstash Forwarder</code>.</p>

<p><a href="https://github.com/elastic/logstash-forwarder"><code class="highlighter-rouge">Logstash Forwarder</code> (a.k.a. <code class="highlighter-rouge">lumberjack</code>)</a> is the protocol used to ship, parse and collect streams or log-events when using ELK.<br />
<code class="highlighter-rouge">Logstash Forwarder</code> can be downloaded and compiled using the Go compiler on your Raspberry Pi, <a href="http://michaelblouin.ca/blog/2015/06/08/build-run-logstash-forwarder-rasperry-pi">for further information you can use this link</a>.</p>

<p><strong>2) <a href="https://github.com/elastic/beats/tree/master/filebeat">Elastic Filebeat</a></strong></p>

<blockquote>
  <p>Filebeat is a lightweight, open source shipper for log file data. As the next-generation <a href="https://github.com/elastic/logstash-forwarder"><code class="highlighter-rouge">Logstash Forwarder</code></a>, Filebeat tails logs and<br />
 quickly sends this information to Logstash for further parsing and enrichment or to Elasticsearch for centralized storage and analysis.<br />
Installing and configuring <code class="highlighter-rouge">Filebeat</code> is easy and you can use It with Logstash to perform additional processing on the data collected and the <code class="highlighter-rouge">Filebeat</code> replaces <code class="highlighter-rouge">Logstash Forwarder</code>.</p>
</blockquote>

<p><strong>3) <a href="https://flume.apache.org">Apache Flume</a></strong></p>

<blockquote>
  <p>Flume is a distributed, reliable, and available service for efficiently collecting, aggregating, and moving large amounts of<br />
 log data. It has a simple and flexible architecture based on streaming data flows. It is robust and fault tolerant with tunable<br />
 reliability mechanisms and many failover and recovery mechanisms. It uses a simple extensible data model that allows for online<br />
 analytic application.<br />
<code class="highlighter-rouge">Apache Flume</code> used Java and requires high (memory and CPU) resources.</p>
</blockquote>

<p><strong>4) <a href="https://github.com/mozilla-services/heka">Mozilla Heka</a></strong></p>

<blockquote>
  <p>Heka is an open source stream processing software system developed by Mozilla. Heka is a “Swiss Army Knife” type tool for data<br />
 processing, useful for a wide variety of different tasks, such as:</p>
  <ul>
    <li>Loading and parsing log files from a file system.</li>
    <li>Accepting statsd type metrics data for aggregation and forwarding to upstream time series data stores such as graphite or InfluxDB.</li>
    <li>Launching external processes to gather operational data from the local system.</li>
    <li>Performing real time analysis, graphing, and anomaly detection on any data flowing through the Heka pipeline.</li>
    <li>Shipping data from one location to another via the use of an external transport (such as AMQP) or directly (via TCP).</li>
    <li>Delivering processed data to one or more persistent data stores.
<code class="highlighter-rouge">Mozilla Heka</code> is very similar to <code class="highlighter-rouge">Logstash Forwarder</code>, both are written in Go, but <code class="highlighter-rouge">Mozilla Heka</code> can process the log-events in real-time also Heka is also able to provide graphs of this data directly, those are great advantages. These graphs will be updated in real time, as the data is flowing through Heka, without the latency of the data store driven graphs.</li>
  </ul>
</blockquote>

<p><strong>5) <a href="https://github.com/fluent/fluentd">Fluentd</a></strong></p>

<blockquote>
  <p>Fluentd is similar to Logstash in that there are inputs and outputs for a large variety of sources and destination. Some of it’s design tenets<br />
 are easy installation and small footprint. It doesn’t provide any storage tier itself but allows you to easily configure where your logs should<br />
 be collected.</p>
</blockquote>

<p><strong>6) <a href="https://thrift.apache.org">Apache Thrift</a></strong></p>

<blockquote>
  <p>Thrift is an interface definition language and binary communication protocol[1] that is used to define and create services for numerous languages.<br />
 It is used as a remote procedure call (RPC) framework and was developed at Facebook for “scalable cross-language services development”. It<br />
 combines a software stack with a code generation engine to build services that work efficiently to a varying degree and seamlessly between C#,<br />
 C++ (on POSIX-compliant systems), Cappuccino, Cocoa, Delphi, Erlang, Go, Haskell, Java, Node.js, OCaml, Perl, PHP, Python, Ruby and Smalltalk.<br />
 Although developed at Facebook, it is now an open source project in the Apache Software Foundation.</p>
</blockquote>

<p><a href="https://github.com/facebookarchive/scribe"><code class="highlighter-rouge">Facebook Scribe</code></a> is a project what uses the <code class="highlighter-rouge">Thrift</code> protocol and is a server for aggregating log data streamed in real time from a large number of servers.
In this Proof-of-Concept I will use Apache Thrift for these reasons:</p>
<ul>
  <li>Apache Thrift is embedded in WSO2 BAM 2.5.0.</li>
  <li>The WSO2 BAM 2.5.0 is a very important component because also It embeds Apache Cassandra to persist the data stream/log-events. You don’t need to do anything, all log-events captured will be stored automatically in Apache Cassandra.</li>
  <li>There are lightweight Python libraries implementing the Apache Thrift protocol, this <a href="https://github.com/wso2-incubator/iot-server-appliances/tree/master/Arduino%20Robot/PC_Clients/PythonRobotController/DirectPublishClient/BAMPythonPublisher">Thrift Python Client</a> is suitable to be used in a Raspberry Pi and publish events int WSO2 BAM (Apache Cassandra).</li>
  <li>And finally, there is a <a href="https://github.com/PaulMcMillan/kismetclient">Python Client Library specific for Kismet</a>. This Python Kismet Client reads the traffic captured for Kismet.</li>
</ul>

<h2 id="ii--installing-configuring-and-running-python-kismet-client-and-python-thrift-library">II.- Installing, configuring and running Python Kismet Client and Python Thrift library</h2>

<p>I cloned the above repositories (<a href="https://github.com/chilcano/iot-server-appliances/tree/master/Arduino%20Robot/PC_Clients/PythonRobotController/DirectPublishClient/BAMPythonPublisher">Thrift Python Client</a> and <a href="https://github.com/chilcano/kismetclient">Python Kismet Client</a>).</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>kismet_to_wso2bam  
<span class="nv">$ </span><span class="nb">cd </span>kismet_to_wso2bam
// Install svn client, It<span class="s1">'s useful to download a folder from a Github repo  
$ sudo apt-get install subversion  
</span></code></pre></div></div>

<p>Replace <code class="highlighter-rouge">tree/master</code> for <code class="highlighter-rouge">trunk</code> in the URL and checkout the folder.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// List files and subfolders  
<span class="nv">$ </span>svn <span class="nb">ls </span>https://github.com/chilcano/iot-server-appliances/trunk/Arduino%20Robot/PC_Clients/PythonRobotController/DirectPublishClient/BAMPythonPublisher  
.gitignore  
BAMPublisher.py  
Publisher.py  
PythonClient.py  
README.md  
gen-py/  
thrift/
// Download files and subfolder  
<span class="nv">$ </span>svn checkout https://github.com/chilcano/iot-server-appliances/trunk/Arduino%20Robot/PC_Clients/PythonRobotController/DirectPublishClient/BAMPythonPublisher  
</code></pre></div></div>

<p>Now, download the <code class="highlighter-rouge">kismetclient</code> repository.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://github.com/chilcano/kismetclient  
Cloning into <span class="s1">'kismetclient'</span>...  
remote: Counting objects: 100, <span class="k">done</span><span class="nb">.</span>  
remote: Total 100 <span class="o">(</span>delta 0<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>, pack-reused 100  
Receiving objects: 100% <span class="o">(</span>100/100<span class="o">)</span>, 15.84 KiB, <span class="k">done</span><span class="nb">.</span>  
Resolving deltas: 100% <span class="o">(</span>57/57<span class="o">)</span>, <span class="k">done</span><span class="nb">.</span>  
</code></pre></div></div>

<p><strong>2.1) Creating a custom Python script to send the Kismet captured traffic to WSO2 BAM 2.5.0</strong></p>

<p>Under <code class="highlighter-rouge">kismet_to_wso2bam</code> folder create this Python (<a href="https://github.com/chilcano/wso2bam-wifi-thrift-cassandra-poc/tree/master/raspberrypi_wifi_traffic_capture/sendTrafficFromKismetToWSO2BAM.py">sendTrafficFromKismetToWSO2BAM.py</a>) script.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">#!/usr/bin/env python  
</span>
<span class="s">"""  
Python script to send 802.11 traffic captured for Kismet to WSO2 BAM 2.5.0.
Author: Chilcano  
Date: 2015/12/31  
Version: 1.0
Requires:  
</span><span class="err">\</span><span class="s">- Python Thrift Client (https://github.com/chilcano/iot-server-appliances/tree/master/Arduino</span><span class="si">%20</span><span class="s">Robot/PC_Clients/PythonRobotController/DirectPublishClient/BAMPythonPublisher)  
</span><span class="err">\</span><span class="s">- Python Kismet Client (https://github.com/chilcano/kismetclient)  
</span><span class="err">\</span><span class="s">- Place the 'sendTrafficFromKismetToWSO2BAM.py' in same level of 'BAMPythonPublisher' and 'kismetclient' folders.
Run:  
$ python sendTrafficFromKismetToWSO2BAM.py  
"""</span>
<span class="kn">import</span> <span class="nn">sys</span>  
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'kismetclient'</span><span class="p">)</span>  
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'BAMPythonPublisher'</span><span class="p">)</span>  
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'BAMPythonPublisher/gen-py'</span><span class="p">)</span>  
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">'BAMPythonPublisher/thrift'</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">kismetclient</span> <span class="kn">import</span> <span class="n">Client</span> <span class="k">as</span> <span class="n">KismetClient</span>  
<span class="kn">from</span> <span class="nn">kismetclient</span> <span class="kn">import</span> <span class="n">handlers</span>  
<span class="kn">from</span> <span class="nn">Publisher</span> <span class="kn">import</span> <span class="o">*</span>  
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">logging</span>  
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">'kismetclient'</span><span class="p">)</span>  
<span class="n">log</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">())</span>  
<span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Kismet server  
</span>
<span class="n">address</span> <span class="o">=</span> <span class="p">(</span><span class="s">'127.0.0.1'</span><span class="p">,</span> <span class="mi">2501</span><span class="p">)</span>  
<span class="n">k</span> <span class="o">=</span> <span class="n">KismetClient</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>  

<span class="c1">##k.register_handler('TRACKINFO', handlers.print_fields)
</span>
<span class="c1"># BAM/CEP/Thrift Server  
</span><span class="n">cep_ip</span> <span class="o">=</span> <span class="s">'192.168.1.43'</span> <span class="c1"># IP address of the server  
</span><span class="n">cep_port</span> <span class="o">=</span> <span class="mi">7713</span> <span class="c1"># Thrift listen port of the server  
</span><span class="n">cep_username</span> <span class="o">=</span> <span class="s">'admin'</span> <span class="c1"># username  
</span><span class="n">cep_password</span> <span class="o">=</span> <span class="s">'admin'</span> <span class="c1"># passowrd
</span>
<span class="c1"># Initialize publisher with ip and port of server  
</span>
<span class="n">publisher</span> <span class="o">=</span> <span class="n">Publisher</span><span class="p">()</span>  
<span class="n">publisher</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">cep_ip</span><span class="p">,</span> <span class="n">cep_port</span><span class="p">)</span>

<span class="c1"># Connect to server with username and password  
</span>
<span class="n">publisher</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cep_username</span><span class="p">,</span> <span class="n">cep_password</span><span class="p">)</span>

<span class="c1"># Define the Input Stream  
</span>
<span class="n">streamDefinition</span> <span class="o">=</span> <span class="s">"{ 'name':'rpi_kismet_stream_in', 'version':'1.0.0', 'nickName': 'rpi_k_in', 'description': '802.11 passive packet capture', 'tags': ['RPi 2 Model B', 'Kismet', 'Thrift'], 'metaData':[ {'name':'ipAdd','type':'STRING'},{'name':'deviceType','type':'STRING'},{'name':'owner','type':'STRING'}, {'name':'bssid','type':'STRING'}], 'payloadData':[ {'name':'macAddress','type':'STRING'}, {'name':'type','type':'STRING'}, {'name':'llcpackets','type':'STRING'}, {'name':'datapackets','type':'STRING'}, {'name':'cryptpackets','type':'STRING'},{'name':'signal_dbm','type':'STRING'}, {'name':'bestlat','type':'STRING'}, {'name':'bestlon','type':'STRING'}, {'name':'bestalt','type':'STRING'}, {'name':'channel','type':'STRING'}, {'name':'datasize','type':'STRING'}, {'name':'newpackets','type':'STRING'}] }"</span><span class="p">;</span>  
<span class="n">publisher</span><span class="o">.</span><span class="n">defineStream</span><span class="p">(</span><span class="n">streamDefinition</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handle_client</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bssid</span><span class="p">,</span> <span class="n">mac</span><span class="p">,</span> <span class="n">lasttime</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">llcpackets</span><span class="p">,</span> <span class="n">datapackets</span><span class="p">,</span> <span class="n">cryptpackets</span><span class="p">,</span> <span class="n">signal_dbm</span><span class="p">,</span> <span class="n">bestlat</span><span class="p">,</span> <span class="n">bestlon</span><span class="p">,</span> <span class="n">bestalt</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">datasize</span><span class="p">,</span> <span class="n">newpackets</span><span class="p">):</span>  
<span class="n">publisher</span><span class="o">.</span><span class="n">publish</span><span class="p">([</span><span class="s">'rpi_chicha'</span><span class="p">,</span> <span class="s">'RPi 2 Model B'</span><span class="p">,</span> <span class="s">'chilcano.io'</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">lasttime</span><span class="p">)],</span> <span class="p">[</span><span class="n">bssid</span><span class="p">,</span> <span class="n">mac</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">llcpackets</span><span class="p">,</span> <span class="n">datapackets</span><span class="p">,</span> <span class="n">cryptpackets</span><span class="p">,</span> <span class="n">signal_dbm</span><span class="p">,</span> <span class="n">bestlat</span><span class="p">,</span> <span class="n">bestlon</span><span class="p">,</span> <span class="n">bestalt</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">datasize</span><span class="p">,</span> <span class="n">newpackets</span><span class="p">])</span>
<span class="n">k</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s">'CLIENT'</span><span class="p">,</span> <span class="n">handle_client</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>  
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>  
<span class="n">k</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>  
<span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>  
<span class="n">pprint</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">protocols</span><span class="p">)</span>  
<span class="n">publisher</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>  
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Exiting...'</span><span class="p">)</span>
</code></pre></div></div>

<p>At the end, the structure of files and directories will be as shown below:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ll  
total 20  
drwxr-xr-x 4 pi pi 4096 Feb 3 14:39 ./  
drwxr-xr-x 11 pi pi 4096 Feb 3 12:10 ../  
drwxr-xr-x 5 pi pi 4096 Feb 3 12:14 BAMPythonPublisher/  
drwxr-xr-x 4 pi pi 4096 Feb 3 12:11 kismetclient/  
<span class="nt">-rw-r--r--</span> 1 pi pi 2552 Feb 3 12:14 sendTrafficFromKismetToWSO2BAM.py
<span class="nv">$ </span>tree <span class="nt">-L</span> 3  
<span class="nb">.</span>  
├── BAMPythonPublisher  
│ ├── BAMPublisher.py  
│ ├── gen-py  
│ │ ├── Data  
│ │ ├── Exception  
│ │ ├── __init__.py  
│ │ ├── ThriftEventTransmissionService  
│ │ └── ThriftSecureEventTransmissionService  
│ ├── Publisher.py  
│ ├── Publisher.pyc  
│ ├── PythonClient.py  
│ ├── README.md  
│ └── thrift  
│ ├── __init__.py  
│ ├── __init__.pyc  
│ ├── protocol  
│ ├── server  
│ ├── Thrift.py  
│ ├── Thrift.pyc  
│ ├── transport  
│ ├── TSCons.py  
│ ├── TSerialization.py  
│ └── TTornado.py  
├── kismetclient  
│ ├── kismetclient  
│ │ ├── client.py  
│ │ ├── client.pyc  
│ │ ├── exceptions.py  
│ │ ├── exceptions.pyc  
│ │ ├── handlers.py  
│ │ ├── handlers.pyc  
│ │ ├── __init__.py  
│ │ ├── __init__.pyc  
│ │ ├── utils.py  
│ │ └── utils.pyc  
│ ├── LICENSE  
│ ├── README.md  
│ ├── runclient.py  
│ └── setup.py  
└── sendTrafficFromKismetToWSO2BAM.py
12 directories, 28 files  
</code></pre></div></div>

<p>Notes:</p>
<ul>
  <li>You have to update the <code class="highlighter-rouge">sendTrafficFromKismetToWSO2BAM.py</code> with IP Address, Username, Password and Ports where WSO2 BAM is running.</li>
  <li>The above Python script reads the captured traffic and defines previously a structure of data to be send to WSO2 BAM (Apache Thrift). You can modify that data structure by adding or removing 802.11 fields.</li>
</ul>

<p><strong>2.2) Install and configure WSO2 BAM to receive the Kismet traffic</strong></p>

<p>Before you run the <code class="highlighter-rouge">sendTrafficFromKismetToWSO2BAM.py</code>, WSO2 BAM 2.5.0 should be running and the Thrift listener port should be open.<br />
The Thrift listener standard port is <code class="highlighter-rouge">7711</code>, in my case I have an offset of <code class="highlighter-rouge">+2</code>.
I recommend you <a href="https://hub.docker.com/r/chilcano/wso2-bam/">my Docker container created to get a fully functional WSO2 BAM 2.5.0</a> ready for use in this PoC with Kismet.<br />
To do that, open a new terminal in your Host PC and execute the next commands:
Initialize the Docker environment.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine <span class="nb">ls</span>
<span class="nv">$ </span>docker-machine start default
<span class="nv">$ </span><span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span>docker-machine <span class="nb">env </span>default<span class="si">)</span><span class="s2">"</span>
<span class="nv">$ </span>docker login  
</code></pre></div></div>

<p>Download the WSO2 BAM Docker image from Docker Hub.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker pull chilcano/wso2-bam:2.5.0
2.5.0: Pulling from chilcano/wso2-bam  
9acb471e45a5: Pull <span class="nb">complete</span>  
...  
e12995f4907c: Pull <span class="nb">complete  
</span>77e4386b8b45: Pull <span class="nb">complete  
</span>Digest: sha256:64e40ea4ea6b89c7e1b08edeb43e31467196a11c9fe755c0026403780f9e24e1  
Status: Downloaded newer image <span class="k">for </span>chilcano/wso2-bam:2.5.0
<span class="nv">$ </span>docker images  
REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE  
chilcano/netcat jessie 302d06d998e6 5 days ago 135.1 MB  
chilcano/rtail-server latest cb313f9e2546 7 days ago 674.2 MB  
ubuntu wily d8a164f81acc 7 days ago 134.4 MB  
ubuntu vivid 99639e3e70c8 7 days ago 131.3 MB  
debian jessie 7a01cc5f27b1 8 days ago 125.1 MB  
node 0.12.9 d09c6f7639f7 13 days ago 637.1 MB  
ubuntu trusty 6cc0fc2a5ee3 2 weeks ago 187.9 MB  
ubuntu precise 6b4adea2c00e 2 weeks ago 137.5 MB  
sebp/elk latest 96f071b7a8e2 3 weeks ago 980.8 MB  
chilcano/wso2-bam 2.5.0 77e4386b8b45 7 weeks ago 1.65 GB  
chilcano/wso2-dss 3.2.1 acd92f55f678 7 weeks ago 1.383 GB  
chilcano/wiremock latest a3e4764483b9 7 weeks ago 597.3 MB  
java openjdk-7 e93dd201a77e 8 weeks ago 589.7 MB
<span class="nv">$ </span>docker run <span class="nt">-d</span> <span class="nt">-t</span> <span class="nt">--name</span><span class="o">=</span>wso2bam-kismet <span class="nt">-p</span> 9445:9443 <span class="nt">-p</span> 7713:7711 chilcano/wso2-bam:2.5.0  
fc9fb8368e7f4f24b01bc33f90122776b4c10d63d0e849073474a485700b6266
<span class="nv">$ </span>docker ps  
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES  
fc9fb8368e7f chilcano/wso2-bam:2.5.0 <span class="s2">"/bin/sh -c 'sh ./wso"</span> 9 seconds ago Up 8 seconds 7611/tcp, 9160/tcp, 9763/tcp, 21000/tcp, 0.0.0.0:7713-&gt;7711/tcp, 0.0.0.0:9445-&gt;9443/tcp wso2bam-kismet  
</code></pre></div></div>

<p>The <code class="highlighter-rouge">9445</code> port is for the WSO2 Carbon Admin Console and the <code class="highlighter-rouge">7713</code> port is the Thrift listener port.<br />
Now, let’s verify that WSO2 BAM is running in the Docker container.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-ti</span> wso2bam-kismet bash
root@fc9fb8368e7f:/opt/wso2bam02a/bin# <span class="nb">tail</span> <span class="nt">-f</span> ../repository/logs/wso2carbon.log  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:10,482] INFO <span class="o">{</span>org.wso2.carbon.ntask.core.service.impl.TaskServiceImpl<span class="o">}</span> - Task service starting <span class="k">in </span>STANDALONE mode... <span class="o">{</span>org.wso2.carbon.ntask.core.service.impl.TaskServiceImpl<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:10,664] INFO <span class="o">{</span>org.apache.cassandra.net.OutboundTcpConnection<span class="o">}</span> - Handshaking version with localhost/127.0.0.1 <span class="o">{</span>org.apache.cassandra.net.OutboundTcpConnection<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:10,672] INFO <span class="o">{</span>org.apache.cassandra.net.OutboundTcpConnection<span class="o">}</span> - Handshaking version with localhost/127.0.0.1 <span class="o">{</span>org.apache.cassandra.net.OutboundTcpConnection<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:11,127] INFO <span class="o">{</span>org.wso2.carbon.ntask.core.impl.AbstractQuartzTaskManager<span class="o">}</span> - Task scheduled: <span class="o">[</span><span class="nt">-1234</span><span class="o">][</span>BAM_NOTIFICATION_DISPATCHER_TASK][NOTIFIER] <span class="o">{</span>org.wso2.carbon.ntask.core.impl.AbstractQuartzTaskManager<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:11,232] INFO <span class="o">{</span>org.wso2.carbon.core.init.JMXServerManager<span class="o">}</span> - JMX Service URL : service:jmx:rmi://localhost:11111/jndi/rmi://localhost:9999/jmxrmi <span class="o">{</span>org.wso2.carbon.core.init.JMXServerManager<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:11,246] INFO <span class="o">{</span>org.wso2.carbon.core.internal.StartupFinalizerServiceComponent<span class="o">}</span> - Server : WSO2BAM02A-2.5.0 <span class="o">{</span>org.wso2.carbon.core.internal.StartupFinalizerServiceComponent<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:11,247] INFO <span class="o">{</span>org.wso2.carbon.core.internal.StartupFinalizerServiceComponent<span class="o">}</span> - WSO2 Carbon started <span class="k">in </span>41 sec <span class="o">{</span>org.wso2.carbon.core.internal.StartupFinalizerServiceComponent<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:14,044] INFO <span class="o">{</span>org.wso2.carbon.dashboard.common.oauth.GSOAuthModule<span class="o">}</span> - Using random key <span class="k">for </span>OAuth client-side state encryption <span class="o">{</span>org.wso2.carbon.dashboard.common.oauth.GSOAuthModule<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:14,714] INFO <span class="o">{</span>org.wso2.carbon.ui.internal.CarbonUIServiceComponent<span class="o">}</span> - Mgt Console URL : https://172.17.0.2:9443/carbon/ <span class="o">{</span>org.wso2.carbon.ui.internal.CarbonUIServiceComponent<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-03 16:38:14,714] INFO <span class="o">{</span>org.wso2.carbon.ui.internal.CarbonUIServiceComponent<span class="o">}</span> - Gadget Server Default Context : http://172.17.0.2:9763/portal <span class="o">{</span>org.wso2.carbon.ui.internal.CarbonUIServiceComponent<span class="o">}</span>  
</code></pre></div></div>

<p><strong>2.3) Remote access of different network (i.e. Raspberry Pi) to the WSO2 BAM Docker container</strong></p>

<p>If you want to get access to WSO2 BAM from a web browser, to use this URL <code class="highlighter-rouge">https://192.168.99.100:9445/carbon/admin</code>, but if you want to connect to embedded Thrift listener, to use this IP Address <code class="highlighter-rouge">192.168.99.100</code> and this <code class="highlighter-rouge">7713</code> port.<br />
That is valid if you are in the same Host PC, but how to get access remotely, for example from the above Raspberry Pi, to the WSO2 BAM Docker Container?.<br />
To do that, follow this explanation (<a href="https://sheerun.net/2014/05/17/remote-access-to-docker-with-tls/">Remote access to Docker with TLS</a>), as It is mentioned, there are 3 choices, as I’m running Docker deamon in a Mac OS X, the easy way to expose and to do available the Docker container to Raspberry Pi network is to do <code class="highlighter-rouge">port forwarding</code> or <code class="highlighter-rouge">SSH tunneling</code> using <code class="highlighter-rouge">docker-machine</code>.
In other words, follow these commands in your Host PC (Mac OS X):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nt">-v</span>  
Docker version 1.9.1, build a34a1d5  
</code></pre></div></div>

<p>As WSO2 BAM opens <code class="highlighter-rouge">9445</code> and <code class="highlighter-rouge">7713</code> ports, then I will open/forward both ports.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine ssh default <span class="nt">-f</span> <span class="nt">-N</span> <span class="nt">-L</span> 192.168.1.43:7713:localhost:7713
// Optional  
<span class="nv">$ </span>docker-machine ssh default <span class="nt">-f</span> <span class="nt">-N</span> <span class="nt">-L</span> 192.168.1.43:9445:localhost:9445  
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li><code class="highlighter-rouge">'-f'</code> requests SSH to go to background just before command execution.</li>
  <li><code class="highlighter-rouge">'-N'</code> allows empty command (useful here to forward ports only).</li>
  <li>The user/password for <code class="highlighter-rouge">boot2docker</code> is <code class="highlighter-rouge">docker/tcuser</code>.
You also can do the same but using the <code class="highlighter-rouge">ssh</code> command:</li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh docker@<span class="si">$(</span>docker-machine ip default<span class="si">)</span> <span class="nt">-f</span> <span class="nt">-N</span> <span class="nt">-L</span> 192.168.1.43:7713:localhost:7713  
</code></pre></div></div>

<p>Now, from the Raspberry Pi, check if WSO2 BAM is reachable.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>nc <span class="nt">-vzw</span> 3 192.168.1.43 7713  
Connection to 192.168.1.43 7713 port <span class="o">[</span>tcp/<span class="k">*</span><span class="o">]</span> succeeded!
// Optional  
<span class="nv">$ </span>nc <span class="nt">-vzw</span> 3 192.168.1.43 9445  
Connection to 192.168.1.43 9445 port <span class="o">[</span>tcp/<span class="k">*</span><span class="o">]</span> succeeded!  
</code></pre></div></div>

<p>Or check It by using <code class="highlighter-rouge">curl</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-Ivsk</span> https://192.168.1.43:9445/carbon/admin/login.jsp <span class="nt">-o</span> /dev/null
...  
&lt; HTTP/1.1 200 OK  
&lt; Set-Cookie: <span class="nv">JSESSIONID</span><span class="o">=</span>601A0F02DCCB47B2685686A7042BBD8F<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> Secure<span class="p">;</span> HttpOnly  
&lt; X-FRAME-OPTIONS: DENY  
&lt; Content-Type: text/html<span class="p">;</span><span class="nv">charset</span><span class="o">=</span>UTF-8  
&lt; Content-Language: en  
&lt; Transfer-Encoding: chunked  
&lt; Vary: Accept-Encoding  
&lt; Date: Thu, 04 Feb 2016 12:14:09 GMT  
&lt; Server: WSO2 Carbon Server  
&lt;  
<span class="k">*</span> Connection <span class="c">#0 to host 192.168.1.43 left intact  </span>
<span class="k">*</span> Closing connection <span class="c">#0  </span>
<span class="k">*</span> SSLv3, TLS alert, Client hello <span class="o">(</span>1<span class="o">)</span>:  
<span class="o">}</span> <span class="o">[</span>data not shown]  
</code></pre></div></div>

<p><strong>2.4) Running the custom Python script to send the captured traffic by Kismet to WSO2 BAM</strong></p>

<p>Make sure that Python is installed, install It if It’s not installed.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python  
Python 2.7.3 <span class="o">(</span>default, Mar 18 2014, 05:13:23<span class="o">)</span>  

<span class="o">[</span>GCC 4.6.3] on linux2  
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.  
<span class="o">&gt;&gt;&gt;</span> quit<span class="o">()</span>  
</code></pre></div></div>

<p>After that, run the Python script, obviously, Kismet should be running.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>kismet_to_wso2bam/
<span class="nv">$ </span>python sendTrafficFromKismetToWSO2BAM.py
<span class="k">*</span>KISMET: <span class="o">[</span><span class="s1">'0.0.0'</span>, <span class="s1">'1454495618'</span>, <span class="s1">'rpi-chicha'</span>, <span class="s1">'pcapdump,netxml,nettxt,gpsxml,alert'</span>, <span class="s1">'1000'</span><span class="o">]</span>  
Server: 0.0.0 1454495618 rpi-chicha pcapdump,netxml,nettxt,gpsxml,alert 1000  
<span class="k">*</span>PROTOCOLS: <span class="o">[</span><span class="s1">'KISMET,ERROR,ACK,PROTOCOLS,CAPABILITY,TERMINATE,TIME,PACKET,STATUS,PLUGIN,SOURCE,ALERT,COMMON,TRACKINFO,WEPKEY,STRING,GPS,BSSID,SSID,CLIENT,BSSIDSRC,CLISRC,NETTAG,CLITAG,REMOVE,CHANNEL,INFO,BATTERY,CRITFAIL'</span><span class="o">]</span>  

<span class="o">!</span>1 CAPABILITY KISMET  

<span class="o">!</span>2 CAPABILITY ERROR  

<span class="o">!</span>3 CAPABILITY ACK  
...  
</code></pre></div></div>

<p>In the WSO2 BAM side you will see the below log events where Raspberry Pi (Kismet) is connecting to WSO2 BAM (Thrift listener) successfully.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-04 12:27:40,542] INFO <span class="o">{</span>org.wso2.carbon.core.services.util.CarbonAuthenticationUtil<span class="o">}</span> - <span class="s1">'admin@carbon.super [-1234]'</span> logged <span class="k">in </span>at <span class="o">[</span>2016-02-04 12:27:40,542+0000] <span class="o">{</span>org.wso2.carbon.core.services.util.CarbonAuthenticationUtil<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-04 12:29:20,334] INFO <span class="o">{</span>org.wso2.carbon.databridge.core.DataBridge<span class="o">}</span> - user admin connected <span class="o">{</span>org.wso2.carbon.databridge.core.DataBridge<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-04 12:29:20,416] INFO <span class="o">{</span>org.wso2.carbon.databridge.streamdefn.registry.datastore.RegistryStreamDefinitionStore<span class="o">}</span> - Stream definition added to registry successfully : rpi_kismet_stream_in:1.0.0 <span class="o">{</span>org.wso2.carbon.databridge.streamdefn.registry.datastore.RegistryStreamDefinitionStore<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-04 12:29:20,670] INFO <span class="o">{</span>org.wso2.carbon.databridge.persistence.cassandra.datastore.ClusterFactory<span class="o">}</span> - Initializing Event cluster <span class="o">{</span>org.wso2.carbon.databridge.persistence.cassandra.datastore.ClusterFactory<span class="o">}</span>  
TID: <span class="o">[</span>0] <span class="o">[</span>BAM] <span class="o">[</span>2016-02-04 12:29:20,877] INFO <span class="o">{</span>org.wso2.carbon.databridge.persistence.cassandra.datastore.ClusterFactory<span class="o">}</span> - Initializing Event Index cluster <span class="o">{</span>org.wso2.carbon.databridge.persistence.cassandra.datastore.ClusterFactory<span class="o">}</span>  
</code></pre></div></div>

<h2 id="iii--exploring-the-80211-captured-traffic-stored-in-apache-cassandra-wso2-bam">III.- Exploring the 802.11 captured traffic stored in Apache Cassandra (WSO2 BAM)</h2>

<p>Remember, the WSO2 BAM 2.5.0 Docker Container is running locally with a internal Docker Machine IP Address (<code class="highlighter-rouge">192.168.99.100</code>), also is running with a public IP Address by using the Host IP Address (<code class="highlighter-rouge">192.168.1.43</code>) because the internal IP address was forwarded.<br />
In brief, WSO2 BAM has the below addresses:</p>
<ul>
  <li>From the Internal Docker Machine IP address:</li>
  <li>WSO2 BAM Admin Web Console: https://192.168.99.100:9445/carbon/admin</li>
  <li>Thrift listener: tcp://192.168.99.100:7713</li>
  <li>From the Public IP address:</li>
  <li>WSO2 BAM Admin Web Console: https://192.168.1.43:9445/carbon/admin</li>
  <li>Thrift listener: tcp://192.168.1.43:7713
Then, let’s go to explore the 802.11 traffic stored in Apache Cassandra.<br />
Below a set of images took when browsing the Apache Cassandra embedded in WSO2 BAM.
<em>01 / WSO2 BAM / Apache Cassandra - Key Spaces</em></li>
</ul>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-2-wso2bam-cassandra-keyspaces.png" alt="WSO2 BAM / Apache Cassandra 01" />
<em>02 / WSO2 BAM / Apache Cassandra - Event KS information</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-3-wso2bam-event-ks-info.png" alt="WSO2 BAM / Apache Cassandra 01" />
<em>03 / WSO2 BAM / Apache Cassandra - Event KS information</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-4-event-ks-info.png" alt="WSO2 BAM / Apache Cassandra 01" />
<em>04 / WSO2 BAM / Apache Cassandra - Connecting to explore KS</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-5-connect-cassandra.png" alt="WSO2 BAM / Apache Cassandra 01" />
<em>05 / WSO2 BAM / Apache Cassandra - List of Key Spaces</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-6-list-keyspaces.png" alt="WSO2 BAM / Apache Cassandra 01" />
<em>06 / WSO2 BAM / Apache Cassandra - Exploring the Kismet data</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-7-kismet-data.png" alt="WSO2 BAM / Apache Cassandra 01" />
<em>07 / WSO2 BAM / Apache Cassandra - Exploring the Kismet data</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_2/chilcano-02-raspberrypi-bigdata-wifi-thrift-8-kismet-data.png" alt="WSO2 BAM / Apache Cassandra 01" />
In the blog post (Part III), I will explain how to create a simple Dashboard showing the WIFI traffic captured in real-time.<br />
See you soon.</p>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://holisticsecurity.io/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/';
      this.page.identifier = 'https://holisticsecurity.io/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://holosec.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2016/02/04/everything-generates-data-capturing-wifi-anonymous-traffic-using-raspberry-pi-and-wso2-bam-part-ii/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><img src="/assets/img/logo-holosec.png" width="40" /> Holistic Security</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Holistic Security</li><li><a class="u-email" href="mailto:blog@holisticsecurity.io">blog@holisticsecurity.io</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Chilcano</span></a></li><li><a href="https://www.linkedin.com/in/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">Chilcano</span></a></li><li><a href="https://www.twitter.com/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">Chilcano</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Systems Thinking, Holism, Trust, Security &amp; Usability.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
