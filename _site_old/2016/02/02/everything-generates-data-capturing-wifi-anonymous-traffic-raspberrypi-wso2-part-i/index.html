<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part I) | Holistic Security</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part I)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Yes, in this digital world, everything generates data, but before to do BigData, you have to follow these steps: Capture: Acquires, Integrates data. Store: Classification, Consolidate, Transformation, Storage Design, etc. Analysis: Exploration, visualization, modeling, prediction, etc. Architecture - Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM and WSO2 CEP" />
<meta property="og:description" content="Yes, in this digital world, everything generates data, but before to do BigData, you have to follow these steps: Capture: Acquires, Integrates data. Store: Classification, Consolidate, Transformation, Storage Design, etc. Analysis: Exploration, visualization, modeling, prediction, etc. Architecture - Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM and WSO2 CEP" />
<link rel="canonical" href="https://holisticsecurity.io/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/" />
<meta property="og:url" content="https://holisticsecurity.io/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/" />
<meta property="og:site_name" content="Holistic Security" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-02-02T12:39:29+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://holisticsecurity.io/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/"},"url":"https://holisticsecurity.io/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/","headline":"Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part I)","dateModified":"2016-02-02T12:39:29+01:00","datePublished":"2016-02-02T12:39:29+01:00","description":"Yes, in this digital world, everything generates data, but before to do BigData, you have to follow these steps: Capture: Acquires, Integrates data. Store: Classification, Consolidate, Transformation, Storage Design, etc. Analysis: Exploration, visualization, modeling, prediction, etc. Architecture - Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM and WSO2 CEP","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://holisticsecurity.io/feed.xml" title="Holistic Security" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156433649-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/"><img src="/assets/img/logo-holosec.png" width="100" /> Holistic Security</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Home</a><a class="page-link" href="/blog/">Blog</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Everything generates data: Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM (Part I)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-02-02T12:39:29+01:00" itemprop="datePublished">Feb 2, 2016 
      </time>&sim; BIG DATA · IOT · SECURITY
      &sim; APACHE CASSANDRA · KISMET · PRIVACY · RASPBERRY PI
    </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Yes, in this digital world, everything generates data, but before to do <code class="highlighter-rouge">BigData</code>, you have to follow these steps:</p>

<ol>
  <li><strong>Capture</strong>: Acquires, Integrates data.</li>
  <li><strong>Store</strong>: Classification, Consolidate, Transformation, Storage Design, etc.</li>
  <li><strong>Analysis</strong>: Exploration, visualization, modeling, prediction, etc.</li>
</ol>

<p><a href="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_1/chilcano-raspberrypi-bigdata-wifi-2-arch.png" target="_blank"><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_1/chilcano-raspberrypi-bigdata-wifi-2-arch.png" alt="" width="70%" /></a><br />
<em>Architecture - Capturing WIFI anonymous traffic using Raspberry Pi and WSO2 BAM and WSO2 CEP</em></p>

<!-- more -->

<p>In this first blog post I will explain how to capture anonymous <a href="https://en.wikipedia.org/wiki/IEEE_802.11">WIFI/802.11 traffic</a> using a <a href="https://www.raspberrypi.org/products/raspberry-pi-2-model-b">Raspberry Pi 2 Model B</a>, Kismet (<a href="https://www.kismetwireless.net">An 802.11 layer2 wireless network detector, sniffer, and intrusion detection system</a>) and in the second blog post I will use <a href="http://wso2.com/more-downloads/business-activity-monitor">WSO2 BAM 2.5.0</a> to collect the anonymous WIFI traffic to generate a simple Dashboard showing data in live or real time.</p>

<p>The final idea is create a simple Dashboard showing the Mobile Devices as mobile phones identified around of the Raspberry Pi.<br />
Anyway, you can use this traffic for different purposes such as:</p>
<ul>
  <li>Monitor Shopping Activity</li>
  <li>Vehicule Traffic Monitoring</li>
  <li>Street Activity Monitoring, …</li>
</ul>

<p>Well, now let’s get down to work.</p>

<h2 id="i-enable-monitor-mode-in-raspberry-pi">I. Enable <em>monitor mode</em> in Raspberry Pi</h2>

<h3 id="1-prepare-the-raspberry-pi">1. Prepare the Raspberry Pi</h3>
<p>Obviously, I have a clean image of Raspbian installed in my Raspberry Pi 2 Model B.<br />
The below steps explain how to prepare Raspberry Pi and install and configure Kismet to capture 802.11 anonymous traffic.
Before to do it, I have to prepare the Raspberry Pi, for example, configure a static IP address to Ethernet interface (<code class="highlighter-rouge">eth0</code>) to get SSH access remotely. After that, I can configure the Wireless interface (<code class="highlighter-rouge">wlan0</code>) and install Kismet.</p>

<p><strong>1.1) Get SSH access to Raspberry Pi</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ssh pi@192.168.1.102  
pi@192.168.1.102<span class="s1">'s password:  
Linux rpi-chicha 3.18.11-v7+ #781 SMP PREEMPT Tue Apr 21 18:07:59 BST 2015 armv7l
The programs included with the Debian GNU/Linux system are free software;  
the exact distribution terms for each program are described in the  
individual files in /usr/share/doc/*/copyright.
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent  
permitted by applicable law.  
Last login: Fri Jan 29 11:32:20 2016 from 192.168.1.43  
</span></code></pre></div></div>

<p><strong>1.2) Connect the USB WIFI dongle</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lsusb  
Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.  
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub  
Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp.  
Bus 001 Device 004: ID 148f:5370 Ralink Technology, Corp. RT5370 Wireless Adapter  
</code></pre></div></div>

<p>Check if your WIFI dongle allows monitor mode.</p>

<blockquote>
  <p><strong>Note:</strong>
<code class="highlighter-rouge">RTL8188CUS</code> does not allow monitor mode.<br />
<a href="http://raspberrypi.stackexchange.com/questions/8578/enable-monitor-mode-in-rtl8188cus-realtek-wifi-usb-dongle">http://raspberrypi.stackexchange.com/questions/8578/enable-monitor-mode-in-rtl8188cus-realtek-wifi-usb-dongle</a></p>
</blockquote>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ifconfig  
<span class="nv">$ </span><span class="nb">sudo </span>ifconfig  
eth0 Link encap:Ethernet HWaddr b8:27:eb:1e:12:63  
inet addr:192.168.1.102 Bcast:192.168.1.255 Mask:255.255.255.0  
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1  
RX packets:32177 errors:0 dropped:568 overruns:0 frame:0  
TX packets:1940 errors:0 dropped:0 overruns:0 carrier:0  
collisions:0 txqueuelen:1000  
RX bytes:2495710 <span class="o">(</span>2.3 MiB<span class="o">)</span> TX bytes:187339 <span class="o">(</span>182.9 KiB<span class="o">)</span>
lo Link encap:Local Loopback  
inet addr:127.0.0.1 Mask:255.0.0.0  
UP LOOPBACK RUNNING MTU:65536 Metric:1  
RX packets:46 errors:0 dropped:0 overruns:0 frame:0  
TX packets:46 errors:0 dropped:0 overruns:0 carrier:0  
collisions:0 txqueuelen:0  
RX bytes:4568 <span class="o">(</span>4.4 KiB<span class="o">)</span> TX bytes:4568 <span class="o">(</span>4.4 KiB<span class="o">)</span>
wlan0 Link encap:Ethernet HWaddr 00:13:ef:c0:21:2b  
UP BROADCAST MULTICAST MTU:1500 Metric:1  
RX packets:2394 errors:0 dropped:0 overruns:0 frame:0  
TX packets:29 errors:0 dropped:0 overruns:0 carrier:0  
collisions:0 txqueuelen:1000  
RX bytes:207760 <span class="o">(</span>202.8 KiB<span class="o">)</span> TX bytes:3764 <span class="o">(</span>3.6 KiB<span class="o">)</span>  
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>iwconfig wlan0  
wlan0 IEEE 802.11bgn ESSID:off/any  
Mode:Managed Access Point: Not-Associated Tx-Power<span class="o">=</span>20 dBm  
Retry short limit:7 RTS thr:off Fragment thr:off  
Encryption key:off  
Power Management:off  

</code></pre></div></div>

<p><strong>1.3) Set static IP address to<code class="highlighter-rouge">eth0</code> and configure <code class="highlighter-rouge">wlan0</code> (optional)</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>nano /etc/network/interfaces  
</code></pre></div></div>

<p>Initial config.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>auto lo
iface lo inet loopback  
iface eth0 inet dhcp
allow-hotplug wlan0  
iface wlan0 inet manual  
wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf  
iface default inet dhcp  
</code></pre></div></div>

<p>Add and configure config for <code class="highlighter-rouge">eth0</code> and <code class="highlighter-rouge">wlan0</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>auto lo
iface lo inet loopback
iface eth0 inet static  
address 192.168.1.102  
netmask 255.255.255.0  
network 192.168.1.0  
broadcast 192.168.1.255  
gateway 192.168.1.1
allow-hotplug wlan0  
auto wlan0  
iface wlan0 inet dhcp  
wpa-ssid <span class="s2">"your-ssid"</span>  
wpa-psk <span class="s2">"your-password"</span>  
</code></pre></div></div>

<p>Reload the changes.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>service networking reload  
</code></pre></div></div>

<p><strong>1.4) Enable<code class="highlighter-rouge">wlan0</code> in monitor mode (option 1)</strong></p>

<p>Run these 2 commands together (*):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>ifconfig wlan0 down<span class="p">;</span><span class="nb">sudo </span>iwconfig wlan0 mode monitor  
</code></pre></div></div>

<p>Now, check if <code class="highlighter-rouge">wlan0</code> is working in mode monitor:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>iwconfig wlan0  
wlan0 IEEE 802.11bgn Mode:Monitor Frequency:2.412 GHz Tx-Power<span class="o">=</span>20 dBm  
Retry long limit:7 RTS thr:off Fragment thr:off  
Power Management:off

<span class="nv">$ </span><span class="nb">sudo </span>ifconfig wlan0  
wlan0 Link encap:UNSPEC HWaddr 00-13-EF-C0-21-2B-70-78-00-00-00-00-00-00-00-00  
UP BROADCAST MULTICAST MTU:1500 Metric:1  
RX packets:764 errors:0 dropped:0 overruns:0 frame:0  
TX packets:8 errors:0 dropped:0 overruns:0 carrier:0  
collisions:0 txqueuelen:1000  
RX bytes:81873 <span class="o">(</span>79.9 KiB<span class="o">)</span> TX bytes:1475 <span class="o">(</span>1.4 KiB<span class="o">)</span>  
</code></pre></div></div>

<p>(*) The raspbian has a service called <code class="highlighter-rouge">ifplugd</code>. This <code class="highlighter-rouge">ifplugd</code> is a daemon which will automatically configure your ethernet device when it is plugged in and automatically unconfigure it if it’s pulled.<br />
So, it does the device stay busy. Disabling it allow you to use ifconfig and iwconfig normally. Just use the comand:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>service ifplugd stop  
<span class="o">[</span> ok <span class="o">]</span> Network Interface Plugging Daemon...stop eth0...stop wlan0...done.

<span class="nv">$ </span><span class="nb">sudo </span>service ifplugd status  

<span class="o">[</span>....] eth0: ifplugd not running.  
<span class="o">[</span>....] wlan0: ifplugd not running.  
<span class="o">[</span>info] all: device all is either not present or not functional.  
</code></pre></div></div>

<p><strong>1.5) Enable<code class="highlighter-rouge">wlan0</code> in monitor mode (option 2)</strong></p>

<p>If above (option 1) configuration not worked, the you could try this alternative by using the <code class="highlighter-rouge">iw</code> scripts. Then, gonna try it.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>iw
<span class="nv">$ </span><span class="nb">sudo </span>iw wlan0 info  
Interface wlan0  
ifindex 3  
<span class="nb">type </span>monitor  
wiphy 0  
</code></pre></div></div>

<p>Add the <code class="highlighter-rouge">mon0</code> in <code class="highlighter-rouge">monitor</code> mode, a new network interface, instead of <code class="highlighter-rouge">wlan0</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>iw phy phy0 interface add mon0 <span class="nb">type </span>monitor  
</code></pre></div></div>

<p>Check the interfaces associated to <code class="highlighter-rouge">phy0</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>iw dev  
phy#0  
Interface mon0  
ifindex 6  
wdev 0x4  
addr 74:f0:6d:4d:40:2f  
<span class="nb">type </span>monitor  
Interface wlan0  
ifindex 5  
wdev 0x3  
addr 74:f0:6d:4d:40:2f  
<span class="nb">type </span>managed  
channel 6 <span class="o">(</span>2437 MHz<span class="o">)</span>, width: 20 MHz, center1: 2437 MHz  
</code></pre></div></div>

<p>Now, we need to remove the <code class="highlighter-rouge">wlan0</code>. If you do that, proably the <code class="highlighter-rouge">mon0</code> interface will be restored to <code class="highlighter-rouge">managed</code> mode.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>iw dev wlan0 del
<span class="nv">$ </span><span class="nb">sudo </span>iw dev  
phy#0  
Interface mon0  
ifindex 8  
wdev 0x6  
addr 74:f0:6d:4d:40:2f  
<span class="nb">type </span>managed  
</code></pre></div></div>

<p>But, to avoid above, you have to configure/set <code class="highlighter-rouge">monitor</code> mode properly with the <code class="highlighter-rouge">ifconfig</code> and <code class="highlighter-rouge">iwconfig</code> commands as follow.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>ifconfig mon0 down  
<span class="nv">$ </span><span class="nb">sudo </span>iwconfig mon0 mode monitor  
<span class="nv">$ </span><span class="nb">sudo </span>ifconfig mon0 up  
</code></pre></div></div>

<p>Now, if you check the interface in <code class="highlighter-rouge">monitor</code> mode, you should see this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>iw dev  
phy#0  
Interface mon0  
ifindex 8  
wdev 0x6  
addr 74:f0:6d:4d:40:2f  
<span class="nb">type </span>monitor  
channel 6 <span class="o">(</span>2437 MHz<span class="o">)</span>, width: 20 MHz <span class="o">(</span>no HT<span class="o">)</span>, center1: 2437 MHz  
</code></pre></div></div>

<p>After that, check if <code class="highlighter-rouge">wlan0</code> or <code class="highlighter-rouge">mon0</code> are running in <code class="highlighter-rouge">monitor</code> mode, if so, then you are ready to start Kismet.</p>

<h2 id="ii-install-configure-and-start-kismet">II. Install, configure and start Kismet</h2>

<p><strong>2.1) Installation of Kismet</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt-get update
<span class="nv">$ </span><span class="nb">sudo </span>apt-get upgrade
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>libncurses5-dev libpcap-dev libpcre3-dev libnl-dev

<span class="c"># latest version - 2015.05.01  </span>

<span class="nv">$ </span>wget http://www.kismetwireless.net/code/kismet-2013-03-R1b.tar.xz 
<span class="nv">$ </span>xz <span class="nt">-d</span> kismet-2013-03-R1b.tar.xz
<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xf</span> kismet-2013-03-R1b.tar
<span class="nv">$ </span><span class="nb">cd </span>kismet-2013-03-R1b
<span class="nv">$ </span>./configure
<span class="nv">$ </span>make
<span class="nv">$ </span><span class="nb">sudo </span>make suidinstall
<span class="nv">$ </span><span class="nb">sudo </span>usermod <span class="nt">-a</span> <span class="nt">-G</span> kismet pi
<span class="nv">$ </span><span class="nb">sudo </span>reboot  
</code></pre></div></div>

<p><strong>2.2) Configure Kismet</strong></p>

<p>Edit <code class="highlighter-rouge">/usr/local/etc/kismet.conf</code> to point at the WIFI adaptor configured in <code class="highlighter-rouge">monitor</code> mode, in this case to add <code class="highlighter-rouge">ncsource=mon0</code> or <code class="highlighter-rouge">ncsource=wlan0</code> and <code class="highlighter-rouge">hidedata=true</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>nano /usr/local/etc/kismet.conf  
</code></pre></div></div>

<p>Download the manufacturer list. This is useful to identify the Wireless Interface Manufacturer.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /usr/share/wireshark/
<span class="nv">$ </span><span class="nb">cd</span> /usr/share/wireshark/
<span class="nv">$ </span><span class="nb">sudo </span>wget <span class="nt">-O</span> manuf http://anonsvn.wireshark.org/wireshark/trunk/manuf
<span class="nv">$ </span><span class="nb">sudo cp </span>manuf /etc/manuf  
</code></pre></div></div>

<p><strong>2.3) Start Kismet Server and Client</strong></p>

<p>If you have configured and updated <code class="highlighter-rouge">/usr/local/etc/kismet.conf</code>, then you can start Kismet running this command (without parameters):</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kismet_server  
</code></pre></div></div>

<p>But, if you haven’t configured <code class="highlighter-rouge">/usr/local/etc/kismet.conf</code> or you want to overwrite It, you can pass these parameters with below command, this will create a TCP listener on port <code class="highlighter-rouge">2501</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kismet_server <span class="nt">-c</span> wlan0
INFO: Not running as root - will try to launch root control binary <span class="o">(</span>/usr/lo  
cal/bin/kismet_capture<span class="o">)</span> to control cards.  
INFO: Started kismet_capture control binary successfully, pid 2517  
INFO: Reading from config file /usr/local/etc/kismet.conf  
debug - 2516 - child creating ipc fdfd  
INFO: No <span class="s1">'dronelisten'</span> config line and no <span class="nb">command </span>line drone-listen  
argument given, Kismet drone server will not be enabled.  
INFO: Created alert tracker...  
INFO: Creating device tracker...  
INFO: Registered 80211 PHY as <span class="nb">id </span>0  
INFO: Kismet will spend extra <span class="nb">time </span>on channels 1,6,11  
INFO: Kismet will attempt to hop channels at 3 channels per second unless  
overridden by source-specific options  
INFO: Matched <span class="nb">source type</span> <span class="s1">'rt2800usb'</span> <span class="k">for </span>auto-type <span class="nb">source</span> <span class="s1">'wlan0'</span>  
INFO: Using hardware channel list 1:3,2,3,4,5,6:3,7,8,9,10,11:3,12,13,14,  
14 channels on <span class="nb">source </span>wlan0  
INFO: Source <span class="s1">'wlan0'</span> will attempt to create and use a monitor-only VAP  
instead of reconfiguring the main interface  
ERROR: Detected the following processes that appear to be using the  
interface wlan0, which can cause problems with Kismet by changing  
the configuration of the network device: wpa_supplicant dhclient  
ifplugd. If Kismet stops running or stops capturing packets, try  
killing one <span class="o">(</span>or all<span class="o">)</span> of these processes or stopping the network <span class="k">for  
</span>this interface.  
INFO: Created <span class="nb">source </span>wlan0 with UUID 52bee95c-c8df-11e5-9fa4-dc04bb23e201  
INFO: Will attempt to reopen on <span class="nb">source</span> <span class="s1">'wlan0'</span> <span class="k">if </span>there are errors  
INFO: Created TCP listener on port 2501  
INFO: Kismet drone framework disabled, drone will not be activated.  
INFO: Inserting basic packet dissectors...  
INFO: <span class="nv">hidedata</span><span class="o">=</span> <span class="nb">set </span><span class="k">in </span>Kismet config. Kismet will ignore the contents of  
data packets entirely  
INFO: Allowing Kismet frontends to view WEP keys  
INFO: Starting GPS components...  
INFO: Enabling reconnection to the GPS device <span class="k">if </span>the <span class="nb">link </span>is lost  
INFO: Using GPSD server on localhost:2947  
INFO: Opened OUI file <span class="s1">'/etc/manuf  
INFO: Indexing manufacturer db  
INFO: Completed indexing manufacturer db, 28150 lines 563 indexes  
INFO: Creating network tracker...  
INFO: Creating channel tracker...  
INFO: Registering dumpfiles...  
INFO: Pcap log in PPI format  
...  
</span></code></pre></div></div>

<p>You can run Kismet Server as a Linux deamon.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kismet_server <span class="nt">-c</span> wlan0 <span class="nt">--daemonize</span>
INFO: Not running as root - will try to launch root control binary <span class="o">(</span>/usr/lo  
cal/bin/kismet_capture<span class="o">)</span> to control cards.  
INFO: Started kismet_capture control binary successfully, pid 4027  
INFO: Reading from config file /usr/local/etc/kismet.conf  
Silencing output and entering daemon mode...  
debug - 4028 - child creating ipc fdfd  
</code></pre></div></div>

<p>And now, start the Kismet Client. The Kismet Client will connect to Kismet Server automatically, because both are running in the same Raspberry Pi.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kismet_client  
</code></pre></div></div>

<p><em>Kismet - Capturing 802.11 anonymous traffic using Raspberry Pi</em></p>

<p><img src="/assets/blog20160203_iot_bigdata_wifi_kismet_wso2bam_1/chilcano-raspberrypi-bigdata-wifi-3-kismet.png" alt="" /><br />
<em>Kismet - Capturing 802.11 anonymous traffic using Raspberry Pi</em></p>

<h2 id="iii-common-kismet-errors">III. Common Kismet errors</h2>

<p><strong>1) Error when start Kismet.<code class="highlighter-rouge">plugins</code> folder not found.</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Failed to open primary plugin directory <span class="o">(</span>/usr/local/lib/kismet/<span class="o">)</span>:  
No such file or directory  
ERROR: Failed to open user plugin directory <span class="o">(</span>/home/pi/.kismet//plugins/<span class="o">)</span>:  
No such file or directory  
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Failed to open primary plugin directory <span class="o">(</span>/usr/lib/kismet/<span class="o">)</span>: No such file or directory  
ERROR: Failed to open user plugin directory <span class="o">(</span>/root/.kismet//plugins/<span class="o">)</span>: No such file or directory  

</code></pre></div></div>

<p><em>Solution:</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /usr/local/lib/kismet/
<span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> /home/pi/.kismet/plugins/  
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /usr/lib/kismet/
<span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> /root/.kismet/plugins/  

</code></pre></div></div>

<p><strong>2) A process is using the wireless interface.</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Didn<span class="s1">'t understand driver '</span>ath9k_htc<span class="s1">' for interface '</span>mon0<span class="s1">', but it  
looks like a mac80211 device so Kismet will use the generic options  
for it. Please post on the Kismet forum or stop by the IRC channel  
and report what driver it was.
ERROR: Detected the following processes that appear to be using the  
interface mon0, which can cause problems with Kismet by changing  
the configuration of the network device: ifplugd. If Kismet stops  
running or stops capturing packets, try killing one (or all) of  
these processes or stopping the network for this interface.  
</span></code></pre></div></div>

<p><em>Solution:</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>pkill wpa_cli<span class="p">;</span> <span class="nb">sudo </span>pkill ifplugd<span class="p">;</span> <span class="nb">sudo </span>pkill wpa_supplicant  
</code></pre></div></div>

<p><strong>3) The manufactur file doesn’t exist.</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Could not open OUI file <span class="s1">'/etc/manuf'</span>: No such file or directory  
ERROR: Could not open OUI file <span class="s1">'/usr/share/wireshark/wireshark/manuf'</span>: No  
such file or directory  
</code></pre></div></div>

<p><em>Solution:</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /usr/share/wireshark/
<span class="nv">$ </span><span class="nb">cd</span> /usr/share/wireshark/
<span class="nv">$ </span><span class="nb">sudo </span>wget <span class="nt">-O</span> manuf http://anonsvn.wireshark.org/wireshark/trunk/manuf
<span class="nv">$ </span><span class="nb">sudo cp </span>manuf /etc/manuf  
</code></pre></div></div>

<p><strong>4) VAP for mon0 wasn’t created.</strong></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Not creating a VAP <span class="k">for </span>mon0 even though one was requested, since  
the interface is already <span class="k">in </span>monitor mode. Perhaps an existing  
monitor mode VAP was specified. To override this and create a new  
monitor mode vap no matter what, use the <span class="nv">forcevap</span><span class="o">=</span><span class="nb">true source </span>option  
</code></pre></div></div>

<p><em>Solution:</em></p>

<p>Check if mon0 is being used for other process or restart and reconfigure your wireless interface.</p>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://holisticsecurity.io/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/';
      this.page.identifier = 'https://holisticsecurity.io/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://holosec.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2016/02/02/everything-generates-data-capturing-wifi-anonymous-traffic-raspberrypi-wso2-part-i/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><img src="/assets/img/logo-holosec.png" width="40" /> Holistic Security</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Holistic Security</li><li><a class="u-email" href="mailto:blog@holisticsecurity.io">blog@holisticsecurity.io</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Chilcano</span></a></li><li><a href="https://www.linkedin.com/in/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">Chilcano</span></a></li><li><a href="https://www.twitter.com/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">Chilcano</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Systems Thinking, Holism, Trust, Security &amp; Usability.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
