<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Wardriving with WIFI Pineapple Nano in Mobile World Congress 2016 at Barcelona | Holistic Security</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Wardriving with WIFI Pineapple Nano in Mobile World Congress 2016 at Barcelona" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="WIFI Pineapple Nano is a nice tiny device to do Wireless Security Auditing. It has OpenWRT embedded as SO with 2 Wireless NIC pre-configured and a lot of Security tools pre-installed ready to perform a Security Wireless Auditing. The idea of this post is to do a quick wardriving around of the Mobile World Congress at Barcelona to check if the attendants are aware about their Mobile Devices with the leak of information. Wardriving at Scale with WIFI Pineapple Nano, Android &amp; Kismet" />
<meta property="og:description" content="WIFI Pineapple Nano is a nice tiny device to do Wireless Security Auditing. It has OpenWRT embedded as SO with 2 Wireless NIC pre-configured and a lot of Security tools pre-installed ready to perform a Security Wireless Auditing. The idea of this post is to do a quick wardriving around of the Mobile World Congress at Barcelona to check if the attendants are aware about their Mobile Devices with the leak of information. Wardriving at Scale with WIFI Pineapple Nano, Android &amp; Kismet" />
<link rel="canonical" href="https://holisticsecurity.io/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/" />
<meta property="og:url" content="https://holisticsecurity.io/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/" />
<meta property="og:site_name" content="Holistic Security" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-02-27T13:27:02+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://holisticsecurity.io/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/"},"url":"https://holisticsecurity.io/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/","headline":"Wardriving with WIFI Pineapple Nano in Mobile World Congress 2016 at Barcelona","dateModified":"2016-02-27T13:27:02+01:00","datePublished":"2016-02-27T13:27:02+01:00","description":"WIFI Pineapple Nano is a nice tiny device to do Wireless Security Auditing. It has OpenWRT embedded as SO with 2 Wireless NIC pre-configured and a lot of Security tools pre-installed ready to perform a Security Wireless Auditing. The idea of this post is to do a quick wardriving around of the Mobile World Congress at Barcelona to check if the attendants are aware about their Mobile Devices with the leak of information. Wardriving at Scale with WIFI Pineapple Nano, Android &amp; Kismet","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://holisticsecurity.io/feed.xml" title="Holistic Security" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-156433649-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/"><img src="/assets/img/logo-holosec.png" width="100" /> Holistic Security</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Home</a><a class="page-link" href="/blog/">Blog</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Wardriving with WIFI Pineapple Nano in Mobile World Congress 2016 at Barcelona</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-02-27T13:27:02+01:00" itemprop="datePublished">Feb 27, 2016 
      </time>&sim; BIG DATA · IOT · OPEN SOURCE · SECURITY
      &sim; OPENWRT · PINEAPPLE · WARDRIVING
    </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="https://www.wifipineapple.com">WIFI Pineapple Nano</a> is a nice tiny device to do Wireless Security Auditing. It has <a href="https://openwrt.org">OpenWRT</a> embedded as SO with 2 Wireless NIC pre-configured and a lot of Security tools pre-installed ready to perform a Security Wireless Auditing.</p>

<p>The idea of this post is to do a quick wardriving around of the <a href="https://www.mobileworldcongress.com">Mobile World Congress at Barcelona</a> to check if the attendants are aware about their Mobile Devices with the leak of information.</p>

<p><a href="/assets/blog20160227_wardriving_at_scale/chilcano-00-android-gps-kismet-pineapple-adb.png" target="_blank"><img src="/assets/blog20160227_wardriving_at_scale/chilcano-00-android-gps-kismet-pineapple-adb.png" alt="" width="70%" height="70%" /></a>
<em>Wardriving at Scale with WIFI Pineapple Nano, Android &amp; Kismet</em></p>

<!-- more -->

<p>At the end, after wardriving, you will get these files (<code class="highlighter-rouge">xyz.alert</code>, <code class="highlighter-rouge">xyz.gpsxml</code>, <code class="highlighter-rouge">xyz.netxml</code> and <code class="highlighter-rouge">xyz.pcapdump</code>), with these files you will can identify the Manufacturer of the device (or model), the geo-position and route followed aproximadely and other information related signal quality.</p>

<h2 id="the-arsenal">The arsenal</h2>

<p>The software and devices I’ve used are the following:</p>
<ul>
  <li><a href="https://www.wifipineapple.com/pages/nano">WIFI Pineapple Nano</a></li>
  <li><a href="http://www.bq.com/es/aquaris-e6">Android Mobile Phone’s GPS</a></li>
  <li><a href="https://play.google.com/store/apps/details?id=com.jillybunch.shareGPS">Share GPS App for Android</a></li>
  <li><a href="https://play.google.com/store/apps/details?id=com.sonelli.juicessh">JuiceSSH App for Android</a></li>
  <li><a href="https://www.kismetwireless.net">Kismet (Client and Server) installed in WIFI Pineapple Nano</a></li>
  <li><a href="http://www.amazon.es/dp/B00RJK8SH6">Aukey 20000mAh Portable External Battery</a></li>
</ul>

<p><img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-01-android-mobile-pineapple-kismet.png" alt="" width="70%" />
<em>The arsenal used at Mobile World Congress 2016 Barcelona</em></p>

<h2 id="configuration">Configuration</h2>

<p>Obviously I have initialised my Pineapple Nano previously and have updated the firmware. But if you haven’t already done so, I recommend the next <a href="https://www.wifipineapple.com/pages/setup">guide</a>. 
The next steps are if you have initialised Pineapple Nano.</p>

<p><strong>1) Connect to WIFI Pineapple and prepare everything</strong></p>

<p>By using USB cable, connect the Pineapple Nano to your PC, in my case I’m using a Virtualbox VM with Kali Linux.<br />
Then, from a Kali Linux (<a href="https://www.kali.org">the best Linux distro for Security Audit</a>) terminal will get the <code class="highlighter-rouge">wp6.sh</code> script and will connect to Pineapple Nano.<br />
The <code class="highlighter-rouge">wp6.sh</code> can be downloaded from here: <a href="https://github.com/hak5darren/wp6">https://github.com/hak5darren/wp6</a></p>

<p><img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-02-config-1-connect-pineapple-wp6.png" alt="" width="70%" /></p>

<p>After that, open your browser in your Kali Linux and connect to <code class="highlighter-rouge">http://172.16.42.1:1471</code>
From the Pineapple Web Admin console, insert the SD and format It. After that, verify if SD was formatted successfully.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# <span class="nb">df</span> <span class="nt">-h</span>  
Filesystem Size Used Available Use% Mounted on  
rootfs 2.3M 900.0K 1.4M 39% /  
/dev/root 12.5M 12.5M 0 100% /rom  
tmpfs 29.9M 3.6M 26.3M 12% /tmp  
/dev/mtdblock3 2.3M 900.0K 1.4M 39% /overlay  
overlayfs:/overlay 2.3M 900.0K 1.4M 39% /  
tmpfs 512.0K 0 512.0K 0% /dev  
/dev/sdcard/sd1 6.2G 14.6M 5.9G 0% /sd  
</code></pre></div></div>

<p>Now, open other Kali Linux terminal and get SSH access to Pineapple Nano and update the packages.</p>

<p><img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-02-config-2-connect-pineapple-ssh.png" alt="" width="70%" />
<em>Kali Linux terminal and get SSH access to Pineapple Nano</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# opkg update
</code></pre></div></div>

<p><strong>2) Install Kismet in the Pineapple Nano</strong></p>

<p>Pineapple Nano has not enough space internally to install things. I recommend you to install your new applications or packages in the SD.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# opkg list | <span class="nb">grep </span>kismet  
kismet-client - 2013-03-R1b-1 - An 802.11 layer2 wireless network detector, sniffer, and intrusion detection system. This package contains the kismet text interface client.  
kismet-drone - 2013-03-R1b-1 - An 802.11 layer2 wireless network detector, sniffer, and intrusion detection system. This package contains the kismet remote sniffing.and monitoring drone.  
kismet-server - 2013-03-R1b-1 - An 802.11 layer2 wireless network detector, sniffer, and intrusion detection system. This package contains the kismet server.
root@Pineapple:~# <span class="c"># opkg --dest sd install kismet-server</span>
root@Pineapple:~# <span class="c"># opkg --dest sd install kismet-client</span>
</code></pre></div></div>

<p><strong>3) Sharing the Android ‘s GPS with the WIFI Pineapple Nano</strong></p>

<p>To do this, we need to connect our Android Mobile to the Pineapple USB 2.0 Host port and from Android share the GPS signal by using ShareGPS app. Before, let’s go to install ADB (<a href="http://developer.android.com/tools/help/adb.html">Android Debug Bridge</a>) in the Pineapple.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# opkg <span class="nt">--dest</span> sd <span class="nb">install </span>adb
Installing adb <span class="o">(</span>android.5.0.2_r1-1<span class="o">)</span> to sd...  
Downloading https://www.wifipineapple.com/nano/packages/adb_android.5.0.2_r1-1_ar71xx.ipk.  
Configuring adb.  
</code></pre></div></div>

<p>Now, from your Pineapple SSH terminal start the ADB service and check if your Android Mobile is recognized for the Pineapple Nano. Before, to enable USB Debugging and enable USB Tethering in your Mobile.
My Android Mobile is recognized with <code class="highlighter-rouge">ID 2a47:0004</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# lsusb  
Bus 001 Device 009: ID 2a47:0004  
Bus 001 Device 004: ID 05e3:0745 Genesys Logic, Inc.  
Bus 001 Device 003: ID 0cf3:9271 Atheros Communications, Inc. AR9271 802.11n  
Bus 001 Device 002: ID 058f:6254 Alcor Micro Corp. USB Hub  
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub  
</code></pre></div></div>

<p>Start ADB service in Pineapple Nano.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# adb devices  
<span class="k">*</span> daemon not running. starting it now on port 5037 <span class="k">*</span>  
<span class="k">*</span> daemon started successfully <span class="k">*</span>  
List of devices attached  
AB010682 unauthorized  
</code></pre></div></div>

<p>In your Android Mobile is prompted to accept connection from Pineapple. Accept It and run again <code class="highlighter-rouge">ADB</code>. You have to see the next as shown below.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# adb devices  
List of devices attached  
AB010682 device  
</code></pre></div></div>

<p>Now, in your Android install the ShareGPS app from Google Play Store. After that, start the app and share the GPS signal.</p>

<p><img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-03-1-small-android-share-gps.png" alt="" width="180" /> <img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-03-2-small-android-share-gps.png" alt="" width="180" /> <img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-03-3-small-android-share-gps.png" alt="" width="180" /> <img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-03-4-small-android-share-gps.png" alt="" width="180" /></p>

<p>Finally, You are ready to use the shared Android’s GPS signal. Let’s to check it.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# adb forward tcp:50000 tcp:50000
root@Pineapple:~# telnet localhost 50000
<span class="nv">$GPGGA</span>,181216.000,4138.5572,N,00221.8326,E,1,5,1.47,202.2,M,51.1,M,,<span class="k">*</span>54  
<span class="nv">$GPGSA</span>,A,3,19,25,24,15,12,,,,,,,,1.70,1.47,0.85<span class="k">*</span>05  
<span class="nv">$GPGSV</span>,3,1,10,12,65,031,34.4,25,61,286,31.7,24,54,116,14.2,14,43,295,<span class="k">*</span>66  
<span class="nv">$GPGSV</span>,3,2,10,29,26,197,25.8,02,21,102,26.9,19,17,041,13.4,06,16,061,17.8<span class="k">*</span>7C  
<span class="nv">$GPGSV</span>,3,3,10,15,09,174,20.0,31,03,303,<span class="k">*</span>6A  
<span class="nv">$GPRMC</span>,181216.000,A,4138.5572,N,00221.8326,E,0.000,104.39,250216,,,A<span class="k">*</span>5B  
<span class="nv">$GPVTG</span>,104.39,T,,M,0.000,N,0.000,K,A<span class="k">*</span>32  
<span class="nv">$GPACCURACY</span>,4.6<span class="k">*</span>0A  
<span class="nv">$GPGGA</span>,181217.000,4138.5572,N,00221.8326,E,1,5,1.47,202.2,M,51.1,M,,<span class="k">*</span>55  
<span class="nv">$GPGSA</span>,A,3,19,25,24,15,12,,,,,,,,1.70,1.47,0.85<span class="k">*</span>05  
<span class="nv">$GPGSV</span>,3,1,10,12,65,031,34.8,25,61,286,31.6,24,54,116,14.2,14,43,295,<span class="k">*</span>6B  
<span class="nv">$GPGSV</span>,3,2,10,29,26,197,23.7,02,21,102,26.9,19,16,041,13.4,06,16,061,17.8<span class="k">*</span>74  
<span class="nv">$GPGSV</span>,3,3,10,15,09,174,19.6,31,03,303,<span class="k">*</span>66  
<span class="nv">$GPRMC</span>,181217.000,A,4138.5572,N,00221.8326,E,0.000,104.39,250216,,,A<span class="k">*</span>5A  
<span class="nv">$GPVTG</span>,104.39,T,,M,0.000,N,0.000,K,A<span class="k">*</span>32  
<span class="nv">$GPACCURACY</span>,4.5<span class="k">*</span>09  
<span class="nv">$GPGGA</span>,181218.000,4138.5572,N,00221.8326,E,1,5,1.47,202.2,M,51.1,M,,<span class="k">*</span>5A  
<span class="nv">$GPGSA</span>,A,3,19,25,24,15,12,,,,,,,,1.70,1.47,0.85<span class="k">*</span>05  
<span class="nv">$GPGSV</span>,3,1,10,12,65,031,34.8,25,61,286,31.6,24,54,116,14.2,14,43,295,<span class="k">*</span>6B  
<span class="nv">$GPGSV</span>,3,2,10,29,26,197,21.6,02,21,102,26.4,19,16,041,13.4,06,16,061,13.8<span class="k">*</span>7E  
<span class="nv">$GPGSV</span>,3,3,10,15,09,174,19.3,31,03,303,<span class="k">*</span>63  
<span class="nv">$GPRMC</span>,181218.000,A,4138.5572,N,00221.8326,E,0.000,104.39,250216,,,A<span class="k">*</span>55  
<span class="nv">$GPVTG</span>,104.39,T,,M,0.000,N,0.000,K,A<span class="k">*</span>32  
^C  
</code></pre></div></div>

<p>After running <code class="highlighter-rouge">telnet localhost 50000</code> you will see in <code class="highlighter-rouge">green</code> on the ShareGPS app connections “Connected” instead of “Listening”. That verifies Pineapple connected to Android’s GPS, also you will see some characters in your terminal demonstrating that everything works.</p>

<p><strong>4) Configuration of Kismet:<code class="highlighter-rouge">wlan1</code> in <code class="highlighter-rouge">monitor mode</code></strong></p>

<p>The WIFI Pineapple Nano has 2 Wireless NICs: <code class="highlighter-rouge">wlan0</code> and <code class="highlighter-rouge">wlan1</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# iwconfig  
lo no wireless extensions.
usb0 no wireless extensions.
wlan1 IEEE 802.11bgn ESSID:off/any  
Mode:Managed Access Point: Not-Associated Tx-Power<span class="o">=</span>20 dBm  
RTS thr:off Fragment thr:off  
Encryption key:off  
Power Management:off
wlan0-1 IEEE 802.11bgn Mode:Master Tx-Power<span class="o">=</span>17 dBm  
RTS thr:off Fragment thr:off  
Power Management:off
wlan0 IEEE 802.11bgn Mode:Master Tx-Power<span class="o">=</span>17 dBm  
RTS thr:off Fragment thr:off  
Power Management:off
eth0 no wireless extensions.
br-lan no wireless extensions.  
</code></pre></div></div>

<p>I’m going to use <code class="highlighter-rouge">wlan1</code> to capture the 802.11 traffic, in fact, the <code class="highlighter-rouge">wlan1</code> will be configured in <code class="highlighter-rouge">monitor mode</code> as shown below:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# ifconfig wlan1 down  
root@Pineapple:~# iwconfig wlan1 mode monitor  
root@Pineapple:~# ifconfig wlan1 up  
</code></pre></div></div>

<p>Check again the wireless interfaces. The <code class="highlighter-rouge">wlan1</code> NIC should be in <code class="highlighter-rouge">monitor mode</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# iwconfig wlan1  
wlan1 IEEE 802.11bgn Mode:Monitor Frequency:2.412 GHz Tx-Power<span class="o">=</span>20 dBm  
RTS thr:off Fragment thr:off  
Power Management:off  
</code></pre></div></div>

<p><strong>5) Configuration of Kismet: MAC Address Manufacturer</strong></p>

<p>Kismet by default hasn’t the MAC Address Manufacturer database, I have to download it from the Wireshark web portal and copy it to <code class="highlighter-rouge">/sd</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# wget <span class="nt">-O</span> /sd/manuf http://anonsvn.wireshark.org/wireshark/trunk/manuf
root@Pineapple:~# <span class="nb">ln</span> <span class="nt">-s</span> /sd/manuf /etc/manuf  
root@Pineapple:~# <span class="nb">ln</span> <span class="nt">-s</span> /sd/manuf /sd/etc/manuf  
</code></pre></div></div>

<p><strong>6) Configuration of Kismet: Installing and configuring GPSd</strong></p>

<blockquote>
  <p><code class="highlighter-rouge">GPSd</code> is a service daemon that monitors one or more GPSes or AIS receivers attached to a host computer through serial or USB ports, making all data on the location/course/velocity of the sensors available to be queried on TCP port 2947 of the host computer.
(http://www.catb.org/gpsd)</p>
</blockquote>

<p><code class="highlighter-rouge">GPSd</code> is not available in the current repository of OpenWRT (<a href="https://downloads.openwrt.org/chaos_calmer/15.05">Chaos Calmer 15.05</a>) used for WIFI Pineapple Nano. Not problem, we can install the all GPSd packages for an older version of OpenWRT.<br />
The packages to be installed are:</p>

<ul>
  <li>libgps_3.7-1_ar71xx.ipk</li>
  <li>libgpsd_3.7-1_ar71xx.ipk</li>
  <li>gpsd_3.7-1_ar71xx.ipk</li>
  <li>gpsd-clients_3.7-1_ar71xx.ipk</li>
</ul>

<p>Download and install them.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# <span class="nb">cd</span> /sd  
root@Pineapple:/sd# wget https://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/packages/libgps_3.7-1_ar71xx.ipk  
root@Pineapple:/sd# wget https://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/packages/libgpsd_3.7-1_ar71xx.ipk  
root@Pineapple:/sd# wget https://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/packages/gpsd_3.7-1_ar71xx.ipk  
root@Pineapple:/sd# wget https://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/packages/gpsd-clients_3.7-1_ar71xx.ipk
root@Pineapple:/sd# opkg <span class="nt">--dest</span> sd <span class="nb">install </span>libgps_3.7-1_ar71xx.ipk  
root@Pineapple:/sd# opkg <span class="nt">--dest</span> sd <span class="nb">install </span>libgpsd_3.7-1_ar71xx.ipk  
root@Pineapple:/sd# opkg <span class="nt">--dest</span> sd <span class="nb">install </span>gpsd_3.7-1_ar71xx.ipk  
root@Pineapple:/sd# opkg <span class="nt">--dest</span> sd <span class="nb">install </span>gpsd-clients_3.7-1_ar71xx.ipk  
</code></pre></div></div>

<p>Just make sure what <code class="highlighter-rouge">gpsd</code> service not starting on boot.<br />
You can edit <code class="highlighter-rouge">/etc/default/gpsd</code> and set everything to <code class="highlighter-rouge">false</code> and/or run <code class="highlighter-rouge">service gpsd stop</code>.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# nano /etc/default/gpsd  
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Default settings for the gpsd init script and the hotplug wrapper.</span>

<span class="c"># Start the gpsd daemon automatically at boot time  </span>
<span class="nv">START_DAEMON</span><span class="o">=</span><span class="s2">"false"</span>

<span class="c"># Use USB hotplugging to add new USB devices automatically to the daemon  </span>

<span class="nv">USBAUTO</span><span class="o">=</span><span class="s2">"false"</span>

<span class="c"># Devices gpsd should collect to at boot time.  </span>

<span class="c"># They need to be read/writeable, either by user gpsd or the group dialout.  </span>
<span class="nv">DEVICES</span><span class="o">=</span><span class="s2">""</span>

<span class="c"># Other options you want to pass to gpsd  </span>

<span class="nv">GPSD_OPTIONS</span><span class="o">=</span><span class="s2">""</span>  

</code></pre></div></div>

<p>Now, start the <code class="highlighter-rouge">GPSd</code> service. In debug mode:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# gpsd <span class="nt">-F</span> /var/run/gpsd.sock <span class="nt">-N</span> tcp://localhost:50000  
</code></pre></div></div>

<p>Or run it as daemon.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# gpsd <span class="nt">-F</span> /var/run/gpsd.sock tcp://localhost:50000  
</code></pre></div></div>

<p>Where:</p>

<ul>
  <li><code class="highlighter-rouge">-F /var/run/gpsd.sock</code> is the control socket file being used for GPSd.</li>
  <li><code class="highlighter-rouge">tcp://localhost:50000</code> is the shared Andoid’s GPS signal being listening on TCP port.</li>
  <li><code class="highlighter-rouge">-N</code> don’t daemonize, useful for debugging.</li>
</ul>

<p>And to check if GPSd is working, just run this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# cgps  
</code></pre></div></div>

<p><strong>7) Starting Kismet for the first time</strong></p>

<p>Now, we are ready to start Kismet. Kismet is a Client/Server application, firstly, I will start the Kismet Server and secondly the Kismet Client.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# kismet_server <span class="nt">-p</span> /sd/.kismet <span class="nt">-c</span> wlan1 <span class="nt">--daemonize</span>  
</code></pre></div></div>

<p>Where:</p>
<ul>
  <li><code class="highlighter-rouge">-p /sd/.kismet</code> is the folder where Kismet Server will place the log files.</li>
  <li><code class="highlighter-rouge">-c wlan1</code> is the NIC in <code class="highlighter-rouge">monitor mode</code> to be used.</li>
  <li>Kismet has by default the GPSd configured properly. Nothing to fo here.</li>
  <li>Kismet will look for the MAC Address Manufacturer file in this path <code class="highlighter-rouge">/etc/manuf</code>.</li>
</ul>

<p>In other terminal run the next:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# kismet_client  
</code></pre></div></div>

<p>You should see the Kismet UI showning the Wireless Networks and connected clientes identified and reading the GPS coordinates in real-time.</p>

<p><strong>8) Running Kismet for the next times</strong></p>

<p>Now, if you want to avoid run all above commands one-by-one, you could create a shell script with all required commands.<br />
Then, let’s to create a simple and dirty shell script.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# nano /root/run_wardriving.sh

<span class="c">#!/bin/bash</span>

<span class="nb">echo</span> <span class="s2">"==&gt; Setting wlan1 in monitor mode"</span>  
ifconfig wlan1 down  
iwconfig wlan1 mode monitor  
ifconfig wlan1 up
<span class="nb">echo</span> <span class="s2">"==&gt; Enabling ADB Forwarding to tcp:50000"</span>  
adb forward tcp:50000 tcp:50000
<span class="nb">echo</span> <span class="s2">"==&gt; Refreshing NTP server"</span>  
killall ntpd  
ntpd <span class="o">&gt;</span> /dev/null 2&gt;&amp;1 &amp;  
<span class="nb">sleep </span>3
<span class="nb">echo</span> <span class="s2">"==&gt; Starting GPSD with tcp://localhost:50000"</span>  
service gpsd stop  
killall gpsd  
gpsd <span class="nt">-F</span> /var/run/gpsd.sock tcp://localhost:50000  
<span class="nb">sleep </span>3
<span class="nb">echo</span> <span class="s2">"==&gt; Starting Kismet server in background"</span>  
killall kismet_server  
kismet_server <span class="nt">-p</span> /sd/.kismet <span class="nt">-c</span> wlan1 <span class="nt">--daemonize</span>  
</code></pre></div></div>

<p>And executions privileges.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@Pineapple:~# <span class="nb">chmod</span> +x /root/run_wardriving.sh  
</code></pre></div></div>

<p>The <code class="highlighter-rouge">run_wardriving.sh</code> will be useful when starting Kismet for the next times, because you have to do from your Android mobile and don’t from your PC or Kali Linux.<br />
You will need something likes that shell script to start wardriving quickly and from your Android mobile.<br />
For that, you will need also <a href="https://play.google.com/store/apps/details?id=com.sonelli.juicessh">JuiceSSH App</a> in your Android mobile to connect to WIFI Pineapple Nano and execute the <code class="highlighter-rouge">run_wardriving.sh</code> script. ;)</p>

<h2 id="some-results">Some results</h2>

<p>Below some screenshots taken from my Android mobile and Google Earth with the WIFI Networks placed.</p>

<p><strong>1) Kismet in action</strong></p>

<p><img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-04-1-small-screenshot-kismet-in-action.png" alt="" width="220" /> <img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-04-2-small-screenshot-kismet-693-networks.png" alt="" width="220" /> <img src="/assets/blog20160227_wardriving_at_scale/blog-chilcano-04-3-small-screenshot-kismet-rogue-ap.png" alt="" width="220" /></p>

<p><strong>2) Creating Wireless Recon Maps with Google Earth and GISKismet</strong></p>

<blockquote>
  <p><strong>GISKismet</strong> is a wireless recon visualization tool to represent data gathered using Kismet in a flexible manner. GISKismet stores the information in a database so that the user can generate graphs using SQL. GISKismet currently uses SQLite for the database and GoogleEarth / KML files for graphing.
<a href="http://git.kali.org/gitweb/?p=packages/giskismet.git">http://git.kali.org/gitweb/?p=packages/giskismet.git</a></p>
</blockquote>

<iframe src="https://player.vimeo.com/video/156948434" width="640" height="500" frameborder="0" allow="autoplay; fullscreen" allowfullscreen="">
</iframe>

<h2 id="conclusions">Conclusions</h2>

<ul>
  <li>WIFI Pineapple has a tons of Security tools installed, but not tools to perform a Wardriving. For that Kismet and GPS were installed and configured. <a href="https://www.wifipineapple.com/modules">Probably in the following blog post I will explain how to create a <code class="highlighter-rouge">Module</code></a> for Wardriving.</li>
  <li><strong>Turn off your phone mobile</strong>. The new mobiles or smartphones (Android, iOS, Windows, …) have a Wireless Network Interface, they are constantly trying to connect to Wireless networks, to do that, all Mobiles send packets asking for Access Points. Kismet or other Tools taken advantage of that by capturing these packets. If you want to avoid that, just turn off your Wireless Network Interface and avoid to connect to Wireless Access Point unknown.</li>
  <li><strong>The tip of the iceberg</strong>. The packets that your phone Mobile emits and captures Kismet is only basic information and does not represent any risk to you. This phase is called Security “Data gathering” or “Recognition”. The problem comes later, there are other tools that allow a targeted attack to steal important information.</li>
  <li><strong>The business behind of IoT and BigData</strong>. Actually, Marketing Companies and Telecoms are monetizing with the tracking information of phone mobiles. They are taking advantage of radio/cellular signal to track in all the time. With these information the Shopping Company could identify your pattern of behavior, which stores visited, what phone mobile model do you have, etc. Only search in Google “phone mobile wireless anonymous tracking” and will be aware of the industry behind and who is making money.</li>
  <li><strong>There isn’t Security awareness at Mobile World Congress</strong>. Large conferences where there are people crowd (and thousands of mobiles phone) are a breeding ground for scammers and thieves who take advantage of weaknesses or defects of the Organization, the Devices or the Apps. Then, my friend be careful with that.</li>
</ul>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://holisticsecurity.io/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/';
      this.page.identifier = 'https://holisticsecurity.io/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://holosec.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2016/02/27/wardriving-wifi-pineapple-nano-mobile-world-congress-2016-barcelona/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading"><img src="/assets/img/logo-holosec.png" width="40" /> Holistic Security</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Holistic Security</li><li><a class="u-email" href="mailto:blog@holisticsecurity.io">blog@holisticsecurity.io</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Chilcano</span></a></li><li><a href="https://www.linkedin.com/in/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">Chilcano</span></a></li><li><a href="https://www.twitter.com/Chilcano"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">Chilcano</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Systems Thinking, Holism, Trust, Security &amp; Usability.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
