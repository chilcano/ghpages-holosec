<?xml version="1.0" encoding="UTF-8"?>
<sequence xmlns="http://ws.apache.org/ns/synapse" name="ETMPPrepareRequestSequence">
    <property name="responseType" expression="$trp:Accept" scope="default" type="STRING"/>
    <header name="Authorization" scope="transport" action="remove" description="remove Authorization header"/>
    <property name="access" expression="fn:concat(get-property('username'),':',get-property('password'))" scope="default" type="STRING" description="format username and password"/>
    <header name="Authorization" scope="transport" expression="fn:concat('Basic ', base64Encode(get-property('access')))" description="Add Authorization header"/>
    <payloadFactory media-type="xml">
		<format key="gov:/templates/ETMP_HEART_BEAT_REQUEST_TEMPLATE.xml"/>
        <args>
            <arg evaluator="xml" expression="get-property('senderSystem')"/>
            <arg evaluator="xml" expression="get-property('targetSystem')"/>
        </args>
    </payloadFactory>		
</sequence>
